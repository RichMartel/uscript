// BG2EE Universal Script
// A modification of the Beamdog EE (BDDEFAI) script

// Created By: Rich Martel (richmartel@gmail.com)

// This is a Baldur's Gate II Enhanced Edition AI script for player characters
// and companions that can be used with any class.

// Please read the README.HTM & SPELLS-ITEMS.HTM for more information.

IF
	Global("BDAI_RESET_TIMERS","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("BD_Blind","LOCALS",0)             // TIMER: Blind
		SetGlobal("BD_Cast","LOCALS",0)              // TIMER: Casting Delay
		SetGlobal("BD_ClTm","LOCALS",0)              // TIMER: Anti-Cloud
		SetGlobal("BD_DHarm","LOCALS",0)             // TIMER: Defensive Harmony
		SetGlobal("BD_DInv","LOCALS",0)              // TIMER: Detect Invisibility
		SetGlobal("BD_Glitter","LOCALS",0)           // TIMER: Glitterdust
		SetGlobal("BD_Haste","LOCALS",0)             // TIMER: Haste
		SetGlobal("BD_Hide","LOCALS",0)              // TIMER: Hide in Shadows
		SetGlobal("BD_Horror","LOCALS",0)            // TIMER: Horror
		SetGlobal("BD_RParal","LOCALS",0)            // TIMER: Remove Paralysis
		SetGlobal("BD_SClar","LOCALS",0)             // TIMER: Spiritual Clarity
		SetGlobal("BD_Slow","LOCALS",0)              // TIMER: Slow
		SetGlobal("BD_Spook","LOCALS",0)             // TIMER: Spook
		SetGlobal("BD_Support","LOCALS",0)           // TIMER: Protective buff delay
		SetGlobal("BD_Wand","LOCALS",0)              // TIMER: Wand Delay
		SetGlobal("BDAI_INIT_SKILL","LOCALS",0)      // BOOL : Initialize "Skill Mode"
		SetGlobal("BDAI_INIT_ATTACK","LOCALS",0)     // BOOL : Initialize "Attack Mode"
		SetGlobal("BDAI_INIT_ITEMS","LOCALS",0)      // BOOL : Initialize "Disable Items"
		SetGlobal("BDAI_RESET_TIMERS","GLOBAL",0)    // BOOL : Reset variables
		SetGlobal("BDUAI_INIT_PLAYER1","LOCALS",0)   // BOOL : Initialize "Skill Mode"
		SetGlobal("BDU_BAura","LOCALS",0)            // TIMER: Blackguard Aura of Despair
		SetGlobal("BDU_BrdS","LOCALS",0)             // BOOL : Bard Song 
		SetGlobal("BDU_DCharm","LOCALS",0)           // TIMER: Dire Charm
		SetGlobal("BDU_Displ","LOCALS",0)            // TIMER: Remove Magic
		SetGlobal("BDU_Doom","LOCALS",0)             // TIMER: Doom
		SetGlobal("BDU_Entangle","LOCALS",0)         // TIMER: Entangle
		SetGlobal("BDU_FFists","LOCALS",0)           // TIMER: Flaming Fists
		SetGlobal("BDU_Malison","LOCALS",0)          // TIMER: Greater Malison
		SetGlobal("BDU_Pwr","LOCALS",0)              // TIMER: Power Word (Silence/Stun)
		SetGlobal("BDU_SFire","LOCALS",0)            // TIMER: Spirit Fire
		SetGlobal("BDU_SumIn","LOCALS",0)            // TIMER: Summon Insects
		SetGlobal("BDU_Summon","LOCALS",0)           // TIMER: Summoning Delay
		SetGlobal("BDU_SWard","LOCALS",0)            // TIMER: Spirit Ward
		SetGlobal("BDU_Writhing","LOCALS",0)         // TIMER: Writhing Fog
		SetGlobal("BDU_Web","LOCALS",0)              // TIMER: Web
		SetGlobal("BDU_MoveToHealer","LOCALS",0)     // BOOL : Move to Healer
		SetGlobal("BDU_MoveToPlayer","LOCALS",0)     // BOOL : Move to Player
		SetGlobal("BDU_MoveTimer","LOCALS",0)        // TIMER: Movement
		SetGlobal("BDU_MoveRepeatTimer","LOCALS",0)  // TIMER: Movement Repeat Delay
		SetGlobal("BDU_Protector","LOCALS",0)        // BOOL : "Tank"
		SetGlobal("BDU_Protectors","GLOBAL",0)       // INT  : Number of "Tanks"
		SetGlobal("BDU_SongTimer","LOCALS",0)        // TIMER: Bard Song
		SetGlobal("BDU_SongRepeatTimer","LOCALS",0)  // TIMER: Bard Song Repeat Delay
		SetGlobal("BDU_CloudCast","GLOBAL",0)        // BOOL : Cloud spell cast detected
		SetGlobal("BDU_CloudCastTimer","GLOBAL",0)
		SetGlobal("BDU_InvisibilityCast","GLOBAL",0) // BOOL : Invisibility spell cast detected
		SetGlobal("BDU_InvisibilityCastTimer","GLOBAL",0)
		SetGlobal("BDU_WebCast","GLOBAL",0)          // BOOL : Web spell cast detected
		SetGlobal("BDU_WebCastTimer","GLOBAL",0)
		SetGlobal("BDU_MagicMissileCast","GLOBAL",0) // BOOL : Magic Missile spell cast detected
		SetGlobal("BDU_MagicMissileCastTimer","GLOBAL",0)
		SetGlobal("BDU_P1See","GLOBAL",0)            // BOOL : Player 1 Sees Enemy
		SetGlobal("BDU_P2See","GLOBAL",0)            // BOOL : Player 2 Sees Enemy
		SetGlobal("BDU_P3See","GLOBAL",0)            // BOOL : Player 3 Sees Enemy
		SetGlobal("BDU_P4See","GLOBAL",0)            // BOOL : Player 4 Sees Enemy
		SetGlobal("BDU_P5See","GLOBAL",0)            // BOOL : Player 5 Sees Enemy
		SetGlobal("BDU_P6See","GLOBAL",0)            // BOOL : Player 6 Sees Enemy
		SetGlobal("BDU_InCombat","GLOBAL",0)         // BOOL : Detect Enemy
		Continue()
END

IF
	Global("BDAI_INIT_SKILL","LOCALS",0)
	Global("BDAI_SKILL_MODE","LOCALS",0)
	OR(3)
		Class(Myself,THIEF_ALL)
		Class(Myself,MONK)
		Class(Myself,SHAMAN)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_SKILL","LOCALS",1)
		SetGlobal("BDAI_SKILL_MODE","LOCALS",1)
		Continue()
END

IF
	Global("BDAI_INIT_SKILL","LOCALS",0)
	Global("BDAI_SKILL_MODE","LOCALS",0)
	Class(Myself,RANGER_ALL)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_SKILL","LOCALS",1)
		SetGlobal("BDAI_SKILL_MODE","LOCALS",2)
		Continue()
END

IF
	Global("BDAI_INIT_SKILL","LOCALS",0)
	Global("BDAI_SKILL_MODE","LOCALS",0)
	Class(Myself,BARD_ALL)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_SKILL","LOCALS",1)
		SetGlobal("BDAI_SKILL_MODE","LOCALS",3)
		Continue()
END

IF
	Global("BDAI_INIT_SKILL","LOCALS",0)
	Global("BDAI_SKILL_MODE","LOCALS",0)
	Class(Myself,PALADIN_ALL)
	Class(Myself,CLERIC_ALL)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_SKILL","LOCALS",1)
		SetGlobal("BDAI_SKILL_MODE","LOCALS",4)
		Continue()
END

IF
	Global("BDAI_INIT_ATTACK","LOCALS",0)
	!Global("BDAI_ATTACK_MODE","LOCALS",2)
	Kit(Myself,FERALAN)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_ATTACK","LOCALS",1)
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
		Continue()
END
IF
	Global("BDAI_INIT_ATTACK","LOCALS",0)
	!Global("BDAI_ATTACK_MODE","LOCALS",2)
	OR(5)
		CheckStatGT(Myself,4,PROFICIENCYCROSSBOW)
		CheckStatGT(Myself,4,PROFICIENCYLONGBOW)
		CheckStatGT(Myself,4,PROFICIENCYSHORTBOW)
		CheckStatGT(Myself,4,PROFICIENCYDART)
		CheckStatGT(Myself,4,PROFICIENCYSLING)
	!CheckStatGT(Myself,4,PROFICIENCYBASTARDSWORD)
	!CheckStatGT(Myself,4,PROFICIENCYLONGSWORD)
	!CheckStatGT(Myself,4,PROFICIENCYSHORTSWORD)
	!CheckStatGT(Myself,4,PROFICIENCYAXE)
	!CheckStatGT(Myself,4,PROFICIENCYTWOHANDEDSWORD)
	!CheckStatGT(Myself,4,PROFICIENCYSCIMITARWAKISASHININJATO)
	!CheckStatGT(Myself,4,PROFICIENCYDAGGER)
	!CheckStatGT(Myself,4,PROFICIENCYWARHAMMER)
	!CheckStatGT(Myself,4,PROFICIENCYSPEAR)
	!CheckStatGT(Myself,4,PROFICIENCYHALBERD)
	!CheckStatGT(Myself,4,PROFICIENCYFLAILMORNINGSTAR)
	!CheckStatGT(Myself,4,PROFICIENCYMACE)
	!CheckStatGT(Myself,4,PROFICIENCYQUARTERSTAFF)
	!CheckStatGT(Myself,4,PROFICIENCYCLUB)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_ATTACK","LOCALS",1)
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
		Continue()
END
IF
	Global("BDAI_INIT_ATTACK","LOCALS",0)
	!Global("BDAI_ATTACK_MODE","LOCALS",2)
	OR(5)
		CheckStatGT(Myself,3,PROFICIENCYCROSSBOW)
		CheckStatGT(Myself,3,PROFICIENCYLONGBOW)
		CheckStatGT(Myself,3,PROFICIENCYSHORTBOW)
		CheckStatGT(Myself,3,PROFICIENCYDART)
		CheckStatGT(Myself,3,PROFICIENCYSLING)
	!CheckStatGT(Myself,3,PROFICIENCYBASTARDSWORD)
	!CheckStatGT(Myself,3,PROFICIENCYLONGSWORD)
	!CheckStatGT(Myself,3,PROFICIENCYSHORTSWORD)
	!CheckStatGT(Myself,3,PROFICIENCYAXE)
	!CheckStatGT(Myself,3,PROFICIENCYTWOHANDEDSWORD)
	!CheckStatGT(Myself,3,PROFICIENCYSCIMITARWAKISASHININJATO)
	!CheckStatGT(Myself,3,PROFICIENCYDAGGER)
	!CheckStatGT(Myself,3,PROFICIENCYWARHAMMER)
	!CheckStatGT(Myself,3,PROFICIENCYSPEAR)
	!CheckStatGT(Myself,3,PROFICIENCYHALBERD)
	!CheckStatGT(Myself,3,PROFICIENCYFLAILMORNINGSTAR)
	!CheckStatGT(Myself,3,PROFICIENCYMACE)
	!CheckStatGT(Myself,3,PROFICIENCYQUARTERSTAFF)
	!CheckStatGT(Myself,3,PROFICIENCYCLUB)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_ATTACK","LOCALS",1)
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
		Continue()
END
IF
	Global("BDAI_INIT_ATTACK","LOCALS",0)
	!Global("BDAI_ATTACK_MODE","LOCALS",2)
	OR(5)
		CheckStatGT(Myself,2,PROFICIENCYCROSSBOW)
		CheckStatGT(Myself,2,PROFICIENCYLONGBOW)
		CheckStatGT(Myself,2,PROFICIENCYSHORTBOW)
		CheckStatGT(Myself,2,PROFICIENCYDART)
		CheckStatGT(Myself,2,PROFICIENCYSLING)
	!CheckStatGT(Myself,2,PROFICIENCYBASTARDSWORD)
	!CheckStatGT(Myself,2,PROFICIENCYLONGSWORD)
	!CheckStatGT(Myself,2,PROFICIENCYSHORTSWORD)
	!CheckStatGT(Myself,2,PROFICIENCYAXE)
	!CheckStatGT(Myself,2,PROFICIENCYTWOHANDEDSWORD)
	!CheckStatGT(Myself,2,PROFICIENCYSCIMITARWAKISASHININJATO)
	!CheckStatGT(Myself,2,PROFICIENCYDAGGER)
	!CheckStatGT(Myself,2,PROFICIENCYWARHAMMER)
	!CheckStatGT(Myself,2,PROFICIENCYSPEAR)
	!CheckStatGT(Myself,2,PROFICIENCYHALBERD)
	!CheckStatGT(Myself,2,PROFICIENCYFLAILMORNINGSTAR)
	!CheckStatGT(Myself,2,PROFICIENCYMACE)
	!CheckStatGT(Myself,2,PROFICIENCYQUARTERSTAFF)
	!CheckStatGT(Myself,2,PROFICIENCYCLUB)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_ATTACK","LOCALS",1)
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
		Continue()
END
IF
	Global("BDAI_INIT_ATTACK","LOCALS",0)
	!Global("BDAI_ATTACK_MODE","LOCALS",2)
	OR(5)
		CheckStatGT(Myself,1,PROFICIENCYCROSSBOW)
		CheckStatGT(Myself,1,PROFICIENCYLONGBOW)
		CheckStatGT(Myself,1,PROFICIENCYSHORTBOW)
		CheckStatGT(Myself,1,PROFICIENCYDART)
		CheckStatGT(Myself,1,PROFICIENCYSLING)
	!CheckStatGT(Myself,1,PROFICIENCYBASTARDSWORD)
	!CheckStatGT(Myself,1,PROFICIENCYLONGSWORD)
	!CheckStatGT(Myself,1,PROFICIENCYSHORTSWORD)
	!CheckStatGT(Myself,1,PROFICIENCYAXE)
	!CheckStatGT(Myself,1,PROFICIENCYTWOHANDEDSWORD)
	!CheckStatGT(Myself,1,PROFICIENCYSCIMITARWAKISASHININJATO)
	!CheckStatGT(Myself,1,PROFICIENCYDAGGER)
	!CheckStatGT(Myself,1,PROFICIENCYWARHAMMER)
	!CheckStatGT(Myself,1,PROFICIENCYSPEAR)
	!CheckStatGT(Myself,1,PROFICIENCYHALBERD)
	!CheckStatGT(Myself,1,PROFICIENCYFLAILMORNINGSTAR)
	!CheckStatGT(Myself,1,PROFICIENCYMACE)
	!CheckStatGT(Myself,1,PROFICIENCYQUARTERSTAFF)
	!CheckStatGT(Myself,1,PROFICIENCYCLUB)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_ATTACK","LOCALS",1)
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
		Continue()
END
IF
	Global("BDAI_INIT_ATTACK","LOCALS",0)
	!Global("BDAI_ATTACK_MODE","LOCALS",2)
	OR(5)
		CheckStatGT(Myself,0,PROFICIENCYCROSSBOW)
		CheckStatGT(Myself,0,PROFICIENCYLONGBOW)
		CheckStatGT(Myself,0,PROFICIENCYSHORTBOW)
		CheckStatGT(Myself,0,PROFICIENCYDART)
		CheckStatGT(Myself,0,PROFICIENCYSLING)
	!CheckStatGT(Myself,0,PROFICIENCYBASTARDSWORD)
	!CheckStatGT(Myself,0,PROFICIENCYLONGSWORD)
	!CheckStatGT(Myself,0,PROFICIENCYSHORTSWORD)
	!CheckStatGT(Myself,0,PROFICIENCYAXE)
	!CheckStatGT(Myself,0,PROFICIENCYTWOHANDEDSWORD)
	!CheckStatGT(Myself,0,PROFICIENCYSCIMITARWAKISASHININJATO)
	!CheckStatGT(Myself,0,PROFICIENCYDAGGER)
	!CheckStatGT(Myself,0,PROFICIENCYWARHAMMER)
	!CheckStatGT(Myself,0,PROFICIENCYSPEAR)
	!CheckStatGT(Myself,0,PROFICIENCYHALBERD)
	!CheckStatGT(Myself,0,PROFICIENCYFLAILMORNINGSTAR)
	!CheckStatGT(Myself,0,PROFICIENCYMACE)
	!CheckStatGT(Myself,0,PROFICIENCYQUARTERSTAFF)
	!CheckStatGT(Myself,0,PROFICIENCYCLUB)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_ATTACK","LOCALS",1)
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
		Continue()
END

IF
	Global("BDAI_INIT_ITEMS","LOCALS",0)
THEN
	RESPONSE #100
		SetGlobal("BDAI_INIT_ITEMS","LOCALS",1)
		SetGlobal("BDAI_DISABLE_ITEMS","LOCALS",0)
		Continue()
END

IF
	Global("BDUAI_INIT_PLAYER1","LOCALS",0)
	InPartySlot(Myself,0)
THEN
	RESPONSE #100
		SetGlobal("BDUAI_INIT_PLAYER1","LOCALS",1)
		SetGlobal("BDAI_DISABLE_ITEMS","LOCALS",0)
		SetGlobal("BDUAI_DISABLE_MOVEMENT","LOCALS",0)
		Continue()
END

IF
	Global("BDAI_NO_ARCANE","LOCALS",1)
	Global("BribedCowled","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobal("BDAI_NO_ARCANE","LOCALS",0)
		Continue()
END

IF
	Global("BDAI_NO_ARCANE","LOCALS",0)
	Global("BribedCowled","GLOBAL",0)
	AreaType(OUTDOOR)
	OR(7)
		AreaCheck("AR0020")
		AreaCheck("AR0300")
		AreaCheck("AR0400")
		AreaCheck("AR0500")
		AreaCheck("AR0700")
		AreaCheck("AR0900")
		AreaCheck("AR1000")
THEN
	RESPONSE #100
		SetGlobal("BDAI_NO_ARCANE","LOCALS",1)
		Continue()
END

IF
	Global("BDAI_NO_ARCANE","LOCALS",1)
	!AreaType(OUTDOOR)
THEN
	RESPONSE #100
		SetGlobal("BDAI_NO_ARCANE","LOCALS",0)
		Continue()
END

IF
	Global("BDAI_NO_ARCANE","LOCALS",1)
	!AreaCheck("AR0020")
	!AreaCheck("AR0300")
	!AreaCheck("AR0400")
	!AreaCheck("AR0500")
	!AreaCheck("AR0700")
	!AreaCheck("AR0900")
	!AreaCheck("AR1000")
THEN
	RESPONSE #100
		SetGlobal("BDAI_NO_ARCANE","LOCALS",0)
		Continue()
END

//---------
// HOTKEYS
//---------

// [D]isable AI Toggle
IF
	HotKey(D)
	Global("BDUAI_DISABLE_AI","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // "Off"
		SetGlobal("BDUAI_DISABLE_AI","LOCALS",1)
END
IF
	HotKey(D)
	Global("BDUAI_DISABLE_AI","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // "On"
		SetGlobal("BDUAI_DISABLE_AI","LOCALS",0)
END
IF
	Global("BDUAI_DISABLE_AI","LOCALS",1)
THEN
	RESPONSE #100
		NoAction()
END

// [S]pellcasting Toggle
IF
	HotKey(S)
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // "Off"
		SetGlobal("BDAI_DISABLE_OFFENSIVE","LOCALS",1)
		SetGlobal("BDAI_DISABLE_DEFENSIVE","LOCALS",1)
		SetGlobal("BDAI_DISABLE_SPECIAL","LOCALS",1)
END
IF
	HotKey(S)
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // "On"
		SetGlobal("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
		SetGlobal("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
		SetGlobal("BDAI_DISABLE_SPECIAL","LOCALS",0)
END

// [E]quipment/Item Use Toggle
IF
	HotKey(E)
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // "Off"
		SetGlobal("BDAI_DISABLE_ITEMS","LOCALS",1)
END
IF
	HotKey(E)
	Global("BDAI_DISABLE_ITEMS","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // "On"
		SetGlobal("BDAI_DISABLE_ITEMS","LOCALS",0)
END

// [N]o Movement Toggle
IF
	HotKey(N)
	Global("BDUAI_DISABLE_MOVEMENT","LOCALS",0)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16470)  // "Off"
		SetGlobal("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
END
IF
	HotKey(N)
	Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,16469)  // "On"
		SetGlobal("BDUAI_DISABLE_MOVEMENT","LOCALS",0)
END

// [F]rontline Melee / Ranged Toggle
IF
	HotKey(F)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,9403)  // "Missile Weapons"
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
END
IF
	HotKey(F)
	Global("BDAI_ATTACK_MODE","LOCALS",2)
THEN
	RESPONSE #100
		DisplayStringHead(Myself,15529)  // "Melee"
		SetGlobal("BDAI_ATTACK_MODE","LOCALS",1)
END

//-------------
// ATTACK MODE
//-------------

IF
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	ActionListEmpty()
	InParty(Myself)
	IsWeaponRanged(Myself)
	Range(NearestEnemyOf(Myself),4)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		Continue()
END
IF
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	ActionListEmpty()
	InParty(Myself)
	IsWeaponRanged(Myself)
	Range(NearestEnemyOf(Myself),4)
THEN
	RESPONSE #100
		EquipMostDamagingMelee()
		Continue()
END
IF
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	ActionListEmpty()
	InParty(Myself)
	!IsWeaponRanged(Myself)
	CheckStatGT(Myself,0,ENTANGLE)
	CanEquipRanged()
	!Range(NearestEnemyOf(Myself),4)
THEN
	RESPONSE #100
		EquipRanged()
		Continue()
END
IF
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	ActionListEmpty()
	InParty(Myself)
	!IsWeaponRanged(Myself)
	CanEquipRanged()
	!Range(NearestEnemyOf(Myself),4)
THEN
	RESPONSE #100
		EquipRanged()
		Continue()
END

//-----------------
// RESET VARIABLES
//-----------------

IF
	PartyRested()
THEN
	RESPONSE #100
		SetGlobal("BD_Blind","LOCALS",0)
		SetGlobal("BD_Cast","LOCALS",0)
		SetGlobal("BDU_Cloud","LOCALS",0)
		SetGlobal("BD_ClTm","LOCALS",0)
		SetGlobal("BD_DHarm","LOCALS",0)
		SetGlobal("BD_DInv","LOCALS",0)
		SetGlobal("BD_Glitter","LOCALS",0)
		SetGlobal("BD_Haste","LOCALS",0)
		SetGlobal("BD_Hide","LOCALS",0)
		SetGlobal("BD_Horror","LOCALS",0)
		SetGlobal("BD_RParal","LOCALS",0)
		SetGlobal("BD_SClar","LOCALS",0)
		SetGlobal("BD_Slow","LOCALS",0)
		SetGlobal("BD_Spook","LOCALS",0)
		SetGlobal("BD_Support","LOCALS",0)
		SetGlobal("BD_Wand","LOCALS",0)
		SetGlobal("BDU_BAura","LOCALS",0)
		SetGlobal("BDU_BrdS","LOCALS",0)
		SetGlobal("BDU_DCharm","LOCALS",0)
		SetGlobal("BDU_Displ","LOCALS",0)
		SetGlobal("BDU_Doom","LOCALS",0)
		SetGlobal("BDU_Entangle","LOCALS",0)
		SetGlobal("BDU_FFists","LOCALS",0)
		SetGlobal("BDU_Malison","LOCALS",0)
		SetGlobal("BDU_Pwr","LOCALS",0)
		SetGlobal("BDU_SFire","LOCALS",0)
		SetGlobal("BDU_SumIn","LOCALS",0)
		SetGlobal("BDU_Summon","LOCALS",0)
		SetGlobal("BDU_SWard","LOCALS",0)
		SetGlobal("BDU_Writhing","LOCALS",0)
		SetGlobal("BDU_Web","LOCALS",0)
		SetGlobal("BDU_MoveToHealer","LOCALS",0)
		SetGlobal("BDU_MoveToPlayer","LOCALS",0)
		SetGlobal("BDU_MoveTimer","LOCALS",0)
		SetGlobal("BDU_MoveRepeatTimer","LOCALS",0)
		SetGlobal("BDU_Protector","LOCALS",0)
		SetGlobal("BDU_Protectors","GLOBAL",0)
		SetGlobal("BDU_SongTimer","LOCALS",0)
		SetGlobal("BDU_SongRepeatTimer","LOCALS",0)
		SetGlobal("BDU_CloudCast","GLOBAL",0)
		SetGlobal("BDU_CloudCastTimer","GLOBAL",0)
		SetGlobal("BDU_InvisibilityCast","GLOBAL",0)
		SetGlobal("BDU_InvisibilityCastTimer","GLOBAL",0)
		SetGlobal("BDU_WebCast","GLOBAL",0)
		SetGlobal("BDU_WebCastTimer","GLOBAL",0)
		SetGlobal("BDU_MagicMissileCast","GLOBAL",0)
		SetGlobal("BDU_MagicMissileCastTimer","GLOBAL",0)
		SetGlobal("BDU_P1See","GLOBAL",0)
		SetGlobal("BDU_P2See","GLOBAL",0)
		SetGlobal("BDU_P3See","GLOBAL",0)
		SetGlobal("BDU_P4See","GLOBAL",0)
		SetGlobal("BDU_P5See","GLOBAL",0)
		SetGlobal("BDU_P6See","GLOBAL",0)
		SetGlobal("BDU_InCombat","GLOBAL",0)
		Continue()
END

//-----------
// In Combat
//-----------

IF
	Exists([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_InCombat","GLOBAL",1)
		Continue()
END

//-----------
// SEE ENEMY
//-----------

IF
	InPartySlot(Myself,0)
	Global("BDU_P1See","GLOBAL",1)
	!See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P1See","GLOBAL",0)
		Continue()
END
IF
	InPartySlot(Myself,0)
	Global("BDU_P1See","GLOBAL",0)
	See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P1See","GLOBAL",1)
		Continue()
END

IF
	InPartySlot(Myself,1)
	Global("BDU_P2See","GLOBAL",1)
	!See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P2See","GLOBAL",0)
		Continue()
END
IF
	InPartySlot(Myself,1)
	Global("BDU_P2See","GLOBAL",0)
	See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P2See","GLOBAL",1)
		Continue()
END

IF
	InPartySlot(Myself,2)
	Global("BDU_P3See","GLOBAL",1)
	!See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P3See","GLOBAL",0)
		Continue()
END
IF
	InPartySlot(Myself,2)
	Global("BDU_P3See","GLOBAL",0)
	See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P3See","GLOBAL",1)
		Continue()
END

IF
	InPartySlot(Myself,3)
	Global("BDU_P4See","GLOBAL",1)
	!See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P4See","GLOBAL",0)
		Continue()
END
IF
	InPartySlot(Myself,3)
	Global("BDU_P4See","GLOBAL",0)
	See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P4See","GLOBAL",1)
		Continue()
END

IF
	InPartySlot(Myself,4)
	Global("BDU_P5See","GLOBAL",1)
	!See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P5See","GLOBAL",0)
		Continue()
END
IF
	InPartySlot(Myself,4)
	Global("BDU_P5See","GLOBAL",0)
	See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P5See","GLOBAL",1)
		Continue()
END

IF
	InPartySlot(Myself,5)
	Global("BDU_P6See","GLOBAL",1)
	!See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P6See","GLOBAL",0)
		Continue()
END
IF
	InPartySlot(Myself,5)
	Global("BDU_P6See","GLOBAL",0)
	See([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_P6See","GLOBAL",1)
		Continue()
END

IF
	Global("BDU_InCombat","GLOBAL",1)
	!Global("BDU_P1See","GLOBAL",1)
	!Global("BDU_P2See","GLOBAL",1)
	!Global("BDU_P3See","GLOBAL",1)
	!Global("BDU_P4See","GLOBAL",1)
	!Global("BDU_P5See","GLOBAL",1)
	!Global("BDU_P6See","GLOBAL",1)
	!Exists([EVILCUTOFF])
THEN
	RESPONSE #100
		SetGlobal("BDU_InCombat","GLOBAL",0)
		Continue()
END

IF
	!Global("BDU_InCombat","GLOBAL",1)
	OR(2)
		Global("BDU_Protector","LOCALS",1)
		GlobalGT("BDU_Protectors","GLOBAL",0)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		SetGlobal("BDU_Protectors","GLOBAL",0)
		Continue()
END

IF
	!Global("BDU_InCombat","GLOBAL",1)
	OR(2)
		Global("BDU_MoveToPlayer","LOCALS",1)
		Global("BDU_MoveToHealer","LOCALS",1)
THEN
	RESPONSE #100
		SetGlobal("BDU_MoveToPlayer","LOCALS",0)
		SetGlobal("BDU_MoveToHealer","LOCALS",0)
		SetGlobal("BDU_MoveTimer","LOCALS",0)
		SetGlobal("BDU_MoveRepeatTimer","LOCALS",0)
		ClearActions(Myself)
END

//-----------
// PROTECTOR
//-----------

IF
	!Global("BDU_Protector","LOCALS",1)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	Range(NearestEnemyOf(Myself),8)
	!StateCheck(Myself,STATE_REALLY_DEAD)
	!StateCheck(Myself,STATE_SLEEPING)
	!StateCheck(Myself,STATE_PANIC)
	!StateCheck(Myself,STATE_STUNNED)
	!StateCheck(Myself,STATE_CHARMED)
	!StateCheck(Myself,STATE_CONFUSED)
	HPGT(Myself,150)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",1)
		IncrementGlobal("BDU_Protectors","GLOBAL",1)
		Continue()
END
IF
	!Global("BDU_Protector","LOCALS",1)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	Range(NearestEnemyOf(Myself),8)
	!StateCheck(Myself,STATE_REALLY_DEAD)
	!StateCheck(Myself,STATE_SLEEPING)
	!StateCheck(Myself,STATE_PANIC)
	!StateCheck(Myself,STATE_STUNNED)
	!StateCheck(Myself,STATE_CHARMED)
	!StateCheck(Myself,STATE_CONFUSED)
	!HPGT(Player1,150)
	!HPGT(Player2,150)
	!HPGT(Player3,150)
	!HPGT(Player4,150)
	!HPGT(Player5,150)
	!HPGT(Player6,150)
	HPGT(Myself,125)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",1)
		IncrementGlobal("BDU_Protectors","GLOBAL",1)
		Continue()
END
IF
	!Global("BDU_Protector","LOCALS",1)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	Range(NearestEnemyOf(Myself),8)
	!StateCheck(Myself,STATE_REALLY_DEAD)
	!StateCheck(Myself,STATE_SLEEPING)
	!StateCheck(Myself,STATE_PANIC)
	!StateCheck(Myself,STATE_STUNNED)
	!StateCheck(Myself,STATE_CHARMED)
	!StateCheck(Myself,STATE_CONFUSED)
	!HPGT(Player1,125)
	!HPGT(Player2,125)
	!HPGT(Player3,125)
	!HPGT(Player4,125)
	!HPGT(Player5,125)
	!HPGT(Player6,125)
	HPGT(Myself,100)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",1)
		IncrementGlobal("BDU_Protectors","GLOBAL",1)
		Continue()
END
IF
	!Global("BDU_Protector","LOCALS",1)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	Range(NearestEnemyOf(Myself),8)
	!StateCheck(Myself,STATE_REALLY_DEAD)
	!StateCheck(Myself,STATE_SLEEPING)
	!StateCheck(Myself,STATE_PANIC)
	!StateCheck(Myself,STATE_STUNNED)
	!StateCheck(Myself,STATE_CHARMED)
	!StateCheck(Myself,STATE_CONFUSED)
	!HPGT(Player1,100)
	!HPGT(Player2,100)
	!HPGT(Player3,100)
	!HPGT(Player4,100)
	!HPGT(Player5,100)
	!HPGT(Player6,100)
	HPGT(Myself,80)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",1)
		IncrementGlobal("BDU_Protectors","GLOBAL",1)
		Continue()
END
IF
	!Global("BDU_Protector","LOCALS",1)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	Range(NearestEnemyOf(Myself),8)
	!StateCheck(Myself,STATE_REALLY_DEAD)
	!StateCheck(Myself,STATE_SLEEPING)
	!StateCheck(Myself,STATE_PANIC)
	!StateCheck(Myself,STATE_STUNNED)
	!StateCheck(Myself,STATE_CHARMED)
	!StateCheck(Myself,STATE_CONFUSED)
	!HPGT(Player1,80)
	!HPGT(Player2,80)
	!HPGT(Player3,80)
	!HPGT(Player4,80)
	!HPGT(Player5,80)
	!HPGT(Player6,80)
	HPGT(Myself,62)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",1)
		IncrementGlobal("BDU_Protectors","GLOBAL",1)
		Continue()
END
IF
	!Global("BDU_Protector","LOCALS",1)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	Range(NearestEnemyOf(Myself),8)
	!StateCheck(Myself,STATE_REALLY_DEAD)
	!StateCheck(Myself,STATE_SLEEPING)
	!StateCheck(Myself,STATE_PANIC)
	!StateCheck(Myself,STATE_STUNNED)
	!StateCheck(Myself,STATE_CHARMED)
	!StateCheck(Myself,STATE_CONFUSED)
	!HPGT(Player1,62)
	!HPGT(Player2,62)
	!HPGT(Player3,62)
	!HPGT(Player4,62)
	!HPGT(Player5,62)
	!HPGT(Player6,62)
	HPGT(Myself,50)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",1)
		IncrementGlobal("BDU_Protectors","GLOBAL",1)
		Continue()
END
IF
	!Global("BDU_Protector","LOCALS",1)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	Range(NearestEnemyOf(Myself),8)
	!StateCheck(Myself,STATE_REALLY_DEAD)
	!StateCheck(Myself,STATE_SLEEPING)
	!StateCheck(Myself,STATE_PANIC)
	!StateCheck(Myself,STATE_STUNNED)
	!StateCheck(Myself,STATE_CHARMED)
	!StateCheck(Myself,STATE_CONFUSED)
	!HPGT(Player1,50)
	!HPGT(Player2,50)
	!HPGT(Player3,50)
	!HPGT(Player4,50)
	!HPGT(Player5,50)
	!HPGT(Player6,50)
	HPGT(Myself,40)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",1)
		IncrementGlobal("BDU_Protectors","GLOBAL",1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",1)
	OR(9)
		IsWeaponRanged(Myself)
		!Global("BDAI_ATTACK_MODE","LOCALS",1)
		!Range(NearestEnemyOf(Myself),9)
		StateCheck(Myself,STATE_REALLY_DEAD)
		StateCheck(Myself,STATE_SLEEPING)
		StateCheck(Myself,STATE_PANIC)
		StateCheck(Myself,STATE_STUNNED)
		StateCheck(Myself,STATE_CHARMED)
		StateCheck(Myself,STATE_CONFUSED)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",1)
	OR(6)
		HPGT(Player1,150)
		HPGT(Player2,150)
		HPGT(Player3,150)
		HPGT(Player4,150)
		HPGT(Player5,150)
		HPGT(Player6,150)
	!HPGT(Myself,150)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",1)
	OR(6)
		HPGT(Player1,125)
		HPGT(Player2,125)
		HPGT(Player3,125)
		HPGT(Player4,125)
		HPGT(Player5,125)
		HPGT(Player6,125)
	!HPGT(Myself,125)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",1)
	OR(6)
		HPGT(Player1,100)
		HPGT(Player2,100)
		HPGT(Player3,100)
		HPGT(Player4,100)
		HPGT(Player5,100)
		HPGT(Player6,100)
	!HPGT(Myself,100)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",1)
	OR(6)
		HPGT(Player1,80)
		HPGT(Player2,80)
		HPGT(Player3,80)
		HPGT(Player4,80)
		HPGT(Player5,80)
		HPGT(Player6,80)
	!HPGT(Myself,80)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",1)
	OR(6)
		HPGT(Player1,62)
		HPGT(Player2,62)
		HPGT(Player3,62)
		HPGT(Player4,62)
		HPGT(Player5,62)
		HPGT(Player6,62)
	!HPGT(Myself,62)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",1)
	OR(6)
		HPGT(Player1,50)
		HPGT(Player2,50)
		HPGT(Player3,50)
		HPGT(Player4,50)
		HPGT(Player5,50)
		HPGT(Player6,50)
	!HPGT(Myself,50)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END
IF
	Global("BDU_Protector","LOCALS",1)
	GlobalGT("BDU_Protectors","GLOBAL",0)
	OR(2)
		!HPGT(Myself,40)
		!HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		SetGlobal("BDU_Protector","LOCALS",0)
		IncrementGlobal("BDU_Protectors","GLOBAL",-1)
		Continue()
END

//-----------------
// DETECT SPELLCAST
//-----------------

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(9)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast([EVILCUTOFF.0.0.MAGE_ALL],WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast([EVILCUTOFF.0.0.BARD_ALL],WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast([EVILCUTOFF.0.0.SHAMAN],CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(9)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(SecondNearest([EVILCUTOFF.0.0.SHAMAN]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(9)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(ThirdNearest([EVILCUTOFF.0.0.SHAMAN]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(9)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(FourthNearest([EVILCUTOFF.0.0.SHAMAN]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(9)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(FifthNearest([EVILCUTOFF.0.0.SHAMAN]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(9)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.MAGE_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.BARD_ALL]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(SixthNearest([EVILCUTOFF.0.0.SHAMAN]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(5)
		SpellCast(Nearest([EVILCUTOFF]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(Nearest([EVILCUTOFF]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(Nearest([EVILCUTOFF]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(Nearest([EVILCUTOFF]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(Nearest([EVILCUTOFF]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(5)
		SpellCast(SecondNearest([EVILCUTOFF]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(SecondNearest([EVILCUTOFF]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(SecondNearest([EVILCUTOFF]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(SecondNearest([EVILCUTOFF]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(SecondNearest([EVILCUTOFF]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(5)
		SpellCast(ThirdNearest([EVILCUTOFF]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(ThirdNearest([EVILCUTOFF]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(ThirdNearest([EVILCUTOFF]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(ThirdNearest([EVILCUTOFF]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(ThirdNearest([EVILCUTOFF]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(5)
		SpellCast(FourthNearest([EVILCUTOFF]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(FourthNearest([EVILCUTOFF]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(FourthNearest([EVILCUTOFF]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(FourthNearest([EVILCUTOFF]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(FourthNearest([EVILCUTOFF]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(5)
		SpellCast(FifthNearest([EVILCUTOFF]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(FifthNearest([EVILCUTOFF]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(FifthNearest([EVILCUTOFF]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(FifthNearest([EVILCUTOFF]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(FifthNearest([EVILCUTOFF]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	!Global("BDU_CloudCast","GLOBAL",1)
	OR(5)
		SpellCast(SixthNearest([EVILCUTOFF]),WIZARD_INCENDIARY_CLOUD)  // SPWI810.SPL (Incendiary Cloud)
		SpellCast(SixthNearest([EVILCUTOFF]),WIZARD_STINKING_CLOUD)  // SPWI213.SPL (Stinking Cloud)
		SpellCast(SixthNearest([EVILCUTOFF]),WIZARD_CLOUDKILL)  // SPWI502.SPL (Cloudkill)
		SpellCast(SixthNearest([EVILCUTOFF]),WIZARD_DEATH_FOG)  // SPWI614.SPL (Death Fog)
		SpellCast(SixthNearest([EVILCUTOFF]),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",1)
		SetGlobalTimer("BDU_CloudCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	Global("BDU_CloudCast","GLOBAL",1)
	!GlobalTimerNotExpired("BDU_CloudCastTimer","GLOBAL")
THEN
	RESPONSE #100
		SetGlobal("BDU_CloudCast","GLOBAL",0)
		Continue()
END

IF
	!Global("BDU_InvisibilityCast","GLOBAL",1)
	OR(12)
		SpellCast([EVILCUTOFF],WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast(SecondNearest([EVILCUTOFF]),WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast(ThirdNearest([EVILCUTOFF]),WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast(FourthNearest([EVILCUTOFF]),WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast(FifthNearest([EVILCUTOFF]),WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast(SixthNearest([EVILCUTOFF]),WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
		SpellCast([EVILCUTOFF],WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast(SecondNearest([EVILCUTOFF]),WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast(ThirdNearest([EVILCUTOFF]),WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast(FourthNearest([EVILCUTOFF]),WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast(FifthNearest([EVILCUTOFF]),WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
		SpellCast(SixthNearest([EVILCUTOFF]),WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
THEN
	RESPONSE #100
		SetGlobal("BDU_InvisibilityCast","GLOBAL",1)
		SetGlobalTimer("BDU_InvisibilityCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	Global("BDU_InvisibilityCast","GLOBAL",1)
	!GlobalTimerNotExpired("BDU_InvisibilityCastTimer","GLOBAL")
THEN
	RESPONSE #100
		SetGlobal("BDU_InvisibilityCast","GLOBAL",0)
		Continue()
END

IF
	!Global("BDU_WebCast","GLOBAL",1)
	SpellCast([ANYONE],WIZARD_WEB)  // SPWI215.SPL (Web)
THEN
	RESPONSE #100
		SetGlobal("BDU_WebCast","GLOBAL",1)
		SetGlobalTimer("BDU_WebCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	Global("BDU_WebCast","GLOBAL",1)
	!GlobalTimerNotExpired("BDU_WebCastTimer","GLOBAL")
THEN
	RESPONSE #100
		SetGlobal("BDU_WebCast","GLOBAL",0)
		Continue()
END

IF
	!Global("BDU_MagicMissileCast","GLOBAL",1)
	OR(11)
		SpellCast([EVILCUTOFF],WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(SecondNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(ThirdNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(FourthNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(FifthNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(SixthNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(SeventhNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(EighthNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(NinthNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCast(TenthNearest([EVILCUTOFF]),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
		SpellCastOnMe([ANYONE],WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
THEN
	RESPONSE #100
		SetGlobal("BDU_MagicMissileCast","GLOBAL",1)
		SetGlobalTimer("BDU_MagicMissileCastTimer","GLOBAL",TEN_ROUNDS)
		Continue()
END

IF
	Global("BDU_MagicMissileCast","GLOBAL",1)
	!GlobalTimerNotExpired("BDU_MagicMissileCastTimer","GLOBAL")
THEN
	RESPONSE #100
		SetGlobal("BDU_MagicMissileCast","GLOBAL",0)
		Continue()
END

//------------
// FIND TRAPS
//------------

IF
	ActionListEmpty()
	InParty(Myself)
	!Global("BDU_InCombat","GLOBAL",1)
	!ModalState(DETECTTRAPS)
	!ModalState(STEALTH)
	OR(3)
		Class(Myself,THIEF_ALL)
		Class(Myself,MONK)
		Class(Myself,SHAMAN)
THEN
	RESPONSE #100
		FindTraps()
END

//------------------
// CURE POISON SELF
//------------------

// Cure and heal
IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	HPPercentLT(Myself,85)
	StateCheck(Myself,STATE_POISONED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN17",Myself)  // Elixir of Health
	HPPercentLT(Myself,85)
	StateCheck(Myself,STATE_POISONED)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN17",Myself)  // Elixir of Health
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	HPPercentLT(Myself,40)
	StateCheck(Myself,STATE_POISONED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_HEAL)  // SPPR607.SPL (Heal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	HPPercentLT(Myself,40)
	StateCheck(Myself,STATE_POISONED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
END

// Just cure
IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	StateCheck(Myself,STATE_POISONED)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",Myself)  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN20",Myself)  // Antidote
	StateCheck(Myself,STATE_POISONED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN20",Myself)  // Antidote
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

//-----------
// HEAL SELF
//-----------

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN55",Myself)  // Potion of Superior Healing
	HPPercentLT(Myself,40)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN55",Myself)  // Potion of Superior Healing
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN52",Myself)  // Potion of Extra Healing
	HPPercentLT(Myself,60)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN52",Myself)  // Potion of Extra Healing
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(BLACKGUARD_ABSORB_HEALTH)  // SPCL102.SPL (Absorb Health)
	HPPercentLT(Myself,75)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(NearestEnemyOf(Myself),BLACKGUARD_ABSORB_HEALTH)  // SPCL102.SPL (Absorb Health)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(BLACKGUARD_ABSORB_HEALTH)  // SPCL102.SPL (Absorb Health)
	HPPercentLT(Myself,75)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearestEnemyOf(Myself),BLACKGUARD_ABSORB_HEALTH)  // SPCL102.SPL (Absorb Health)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(BLACKGUARD_ABSORB_HEALTH)  // SPCL102.SPL (Absorb Health)
	HPPercentLT(Myself,75)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(ThirdNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearestEnemyOf(Myself),BLACKGUARD_ABSORB_HEALTH)  // SPCL102.SPL (Absorb Health)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN827")  // Lay On Hands
	HPPercentLT(Myself,70)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN827",Myself)  // Lay On Hands
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
	HPPercentLT(Myself,75)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	!CheckStat(Myself,1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(Myself,7,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(MONK_LAY_ON_HANDS)  // SPCL815.SPL (Lay On Hands)
	HPPercentLT(Myself,75)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,MONK_LAY_ON_HANDS)  // SPCL815.SPL (Lay On Hands)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN106")  // Vampiric Touch
	HPPercentLT(Myself,66)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),6)
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN106",NearestEnemyOf(Myself))  // Vampiric Touch
		SetInterrupt(FALSE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_VAMPIRIC_TOUCH)  // SPWI314.SPL (Vampiric Touch)
	HPPercentLT(Myself,56)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),6)
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_VAMPIRIC_TOUCH)  // SPWI314.SPL (Vampiric Touch)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN17",Myself)  // Elixir of Health
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN17",Myself)  // Elixir of Health
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN08",Myself)  // Potion of Healing
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN08",Myself)  // Potion of Healing
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN104")  // Larloch's Minor Drain
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN104",NearestEnemyOf(Myself))  // Larloch's Minor Drain
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_LARLOCH_MINOR_DRAIN)  // SPWI119.SPL (Larloch's Minor Drain)
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(NearestEnemyOf(Myself),WIZARD_LARLOCH_MINOR_DRAIN)  // SPWI119.SPL (Larloch's Minor Drain)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_LARLOCH_MINOR_DRAIN)  // SPWI119.SPL (Larloch's Minor Drain)
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SALAMANDER)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),SWORD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),75,MAGICDAMAGERESISTANCE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearestEnemyOf(Myself),WIZARD_LARLOCH_MINOR_DRAIN)  // SPWI119.SPL (Larloch's Minor Drain)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
	HPPercentLT(Myself,40)
	Range(SecondNearest([PC]),25)
	OR(2)
		Range(ThirdNearest([PC]),25)
		Range(MostDamagedOf([PC]),25)
	OR(2)
		HPPercentLT(SecondNearest([PC]),71)
		HPPercentLT(ThirdNearest([PC]),71)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	HPPercentLT(Myself,40)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_HEAL)  // SPPR607.SPL (Heal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,LEVELDRAIN)
		StateCheck(Myself,STATE_FEEBLEMINDED)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	HPPercentLT(Myself,40)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	HPPercentLT(Myself,40)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
	HPPercentLT(Myself,60)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
	HPPercentLT(Myself,75)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
	Global("BDU_Protector","LOCALS",1)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	HPPercentLT(Myself,76)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
	HPPercentLT(Myself,79)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN101")  // Cure Light Wounds
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN101",Myself)  // Cure Light Wounds
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
	HPPercentLT(Myself,85)
	OR(2)
		Range(MostDamagedOf([PC]),0)
		HPPercentLT(Myself,50)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
		SetInterrupt(TRUE)
END

//--------------
// QUIET SPELLS
//--------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(Myself,STATE_SILENCED)
	HaveSpell(WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_VOCALIZE)  // SPWI219.SPL (Vocalize)
END

//--------------------
// PREVENT DEATH SELF
//--------------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SANCTUARY)  // SPPR109.SPL (Sanctuary)
	!StateCheck(Myself,STATE_INVISIBLE)
	!CheckStat(Myself,1,SANCTUARY)
	HPPercentLT(Myself,51)
	!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_SANCTUARY)  // SPPR109.SPL (Sanctuary)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
	HPPercentLT(Myself,51)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(Myself,CANNOT_TURN_INVISIBLE)
	!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_IMPROVED_INVISIBILITY)  // SPWI405.SPL (Improved Invisibility)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN10",Myself)  // Potion of Invisibility
	HPPercentLT(Myself,41)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(Myself,CANNOT_TURN_INVISIBLE)
	!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN10",Myself)  // Potion of Invisibility
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
	HPPercentLT(Myself,51)
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
	!CheckSpellState(Myself,CANNOT_TURN_INVISIBLE)
	!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_INVISIBILITY)  // SPWI206.SPL (Invisibility)
END

//----------
// ANTI-AOE
//----------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_ZONE_OF_SWEET_AIR)  // SPPR318.SPL (Zone of Sweet Air)
	Global("BDU_CloudCast","GLOBAL",1)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobal("BDU_CloudCast","LOCALS",0)
		Spell(Myself,CLERIC_ZONE_OF_SWEET_AIR)  // SPPR318.SPL (Zone of Sweet Air)
		SetInterrupt(TRUE)
END

//--------------
// PROTECT SELF
//--------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_IMPROVED_CHAOS_SHIELD)  // SPWI723.SPL (Improved Chaos Shield)
	!CheckSpellState(Myself,IMPROVED_CHAOS_SHIELD)
	Range([EVILCUTOFF],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_IMPROVED_CHAOS_SHIELD)  // SPWI723.SPL (Improved Chaos Shield)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHAOS_SHIELD)  // SPWI222.SPL (Chaos Shield)
	!CheckSpellState(Myself,CHAOS_SHIELD)
	!CheckSpellState(Myself,IMPROVED_CHAOS_SHIELD)
	Range([EVILCUTOFF],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_CHAOS_SHIELD)  // SPWI222.SPL (Chaos Shield)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!StateCheck(Myself,STATE_MIRRORIMAGE)
	HaveSpell(WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
	See(NearestEnemyOf(Myself))
	!CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FifthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SeventhNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(EighthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(NinthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(TenthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT([EVILCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
	!CheckStatGT([EVILCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
	!CheckStat(Myself,1,PUPPETTYPE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
	!CheckSpellState(Myself,BERSERKER_RAGE)
	!CheckSpellState(Myself,BERSERKER_RAGE_FATIGUE)
	Global("BDU_InCombat","GLOBAL",1)
	OR(15)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
	!CheckSpellState(Myself,BARBARIAN_RAGE)
	Global("BDU_InCombat","GLOBAL",1)
	OR(15)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HPPercentLT(Myself,40)
	NumCreatureGT([EVILCUTOFF],3)
	Range([EVILCUTOFF],4)
	!Range([GOODCUTOFF],4)
	HaveSpell(MINSC_BERSERK)  // SPIN117.SPL (Berserk)
	!CheckSpellState(Myself,MINSC_BERSERK)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		ForceSpell(Myself,MINSC_BERSERK)  // SPIN117.SPL (Berserk)
		RemoveSpell(MINSC_BERSERK)  // SPIN117.SPL (Berserk)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("OHRRAGE")  // Animal Rage
	!CheckSpellState(Myself,STATE_ENRAGED)
	Global("BDU_InCombat","GLOBAL",1)
	OR(15)
		CheckStatGT(LastSeenBy(Myself),6,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
		Range([EVILCUTOFF.0.MIND_FLAYER],30)
		Range([EVILCUTOFF.0.DRAGON],30)
		Range([EVILCUTOFF.0.DEMONIC],30)
		Range([EVILCUTOFF.0.BEHOLDER],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.LICH],30)
		Range([EVILCUTOFF.0.DEMILICH],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("OHRRAGE",Myself)  // Animal Rage
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck([GOODCUTOFF],STATE_PANIC)
	See([GOODCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SecondNearest([GOODCUTOFF]),STATE_PANIC)
	See(SecondNearest([GOODCUTOFF]))
	Range(LastSeenBy(Myself),12)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(ThirdNearest([GOODCUTOFF]),STATE_PANIC)
	See(ThirdNearest([GOODCUTOFF]))
	Range(LastSeenBy(Myself),12)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FourthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FourthNearest([GOODCUTOFF]))
	Range(LastSeenBy(Myself),12)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FifthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FifthNearest([GOODCUTOFF]))
	Range(LastSeenBy(Myself),12)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SixthNearest([GOODCUTOFF]),STATE_PANIC)
	See(SixthNearest([GOODCUTOFF]))
	Range(LastSeenBy(Myself),12)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(LATHANDER_BOON)  // SPCL741.SPL (Boon of Lathander)
	!CheckSpellState(Myself,LATHANDER_BOON)
	CheckStat(Myself,0,LEVEL_DRAIN_IMMUNITY)
	!HasItemEquiped("AMUL21",Myself)  // Amulet of Power
	!HasItemEquipedReal("BLUN25",Myself)  // Mace of Disruption +2
	!HasItemEquipedReal("HAMM10",Myself)  // Runehammer +4
	!HasItemEquipedReal("HAMM11",Myself)  // Runehammer +5
	!HasItemEquipedReal("SW1H69",Myself)  // Spectral Brand +5
	OR(5)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.0.SHADOW_DRAGON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,LATHANDER_BOON)  // SPCL741.SPL (Boon of Lathander)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
	OR(2)
		See([EVILCUTOFF.0.DEMILICH])
		See([EVILCUTOFF.0.BEHOLDER])
	Range(LastSeenBy(Myself),30)
	HPGT(LastSeenBy(Myself),20)
	!CheckStatGT(Myself,0,DEATH_WARD)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	!CheckSpellState(Myself,LATHANDER_BOON)
	CheckStat(Myself,0,LEVEL_DRAIN_IMMUNITY)
	!Kit(Myself,UNDEADHUNTER)
	!HasItemEquiped("AMUL21",Myself)  // Amulet of Power
	!HasItemEquipedReal("BLUN25",Myself)  // Mace of Disruption +2
	!HasItemEquipedReal("HAMM10",Myself)  // Runehammer +4
	!HasItemEquipedReal("HAMM11",Myself)  // Runehammer +5
	!HasItemEquipedReal("SW1H69",Myself)  // Spectral Brand +5
	OR(5)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.0.SHADOW_DRAGON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PROTECTION_FROM_ENERGY)  // SPWI803.SPL (Protection From Energy)
	OR(4)
		See([EVILCUTOFF.0.0.MAGE_ALL])
		See([EVILCUTOFF.0.0.CLERIC_ALL])
		See([EVILCUTOFF.0.0.DRUID_ALL])
		See([EVILCUTOFF.0.0.BARD_ALL])
	OR(5)
		CheckStatLT(Myself,75,RESISTFIRE)
		CheckStatLT(Myself,75,RESISTCOLD)
		CheckStatLT(Myself,75,RESISTELECTRICITY)
		CheckStatLT(Myself,75,RESISTACID)
		CheckStatLT(Myself,75,MAGICDAMAGERESISTANCE)
	!HasImmunityEffects(Myself)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_ENERGY)  // SPWI803.SPL (Protection From Energy)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PROTECTION_FROM_THE_ELEMENTS)  // SPWI702.SPL (Protection From The Elements)
	OR(4)
		See([EVILCUTOFF.0.0.MAGE_ALL])
		See([EVILCUTOFF.0.0.CLERIC_ALL])
		See([EVILCUTOFF.0.0.DRUID_ALL])
		See([EVILCUTOFF.0.0.BARD_ALL])
	OR(3)
		CheckStatLT(Myself,75,RESISTFIRE)
		CheckStatLT(Myself,75,RESISTCOLD)
		CheckStatLT(Myself,75,RESISTELECTRICITY)
	!HasImmunityEffects(Myself)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_THE_ELEMENTS)  // SPWI702.SPL (Protection From The Elements)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SPELL_TURNING)  // SPWI701.SPL (Spell Turning)
	OR(4)
		See([EVILCUTOFF.0.0.BARD_ALL])
		See([EVILCUTOFF.0.0.DRUID_ALL])
		See([EVILCUTOFF.0.0.CLERIC_ALL])
		See([EVILCUTOFF.0.0.MAGE_ALL])
	!CheckStatGT(Myself,0,WIZARD_SPELL_TURNING)
	!CheckStatGT(Myself,0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SPELL_TURNING)  // SPWI701.SPL (Spell Turning)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MINOR_SPELL_TURNING)  // SPWI522.SPL (Minor Spell Turning)
	OR(4)
		See([EVILCUTOFF.0.0.BARD_ALL])
		See([EVILCUTOFF.0.0.DRUID_ALL])
		See([EVILCUTOFF.0.0.CLERIC_ALL])
		See([EVILCUTOFF.0.0.MAGE_ALL])
	!CheckStatGT(Myself,0,WIZARD_SPELL_TURNING)
	!CheckStatGT(Myself,0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MINOR_SPELL_TURNING)  // SPWI522.SPL (Minor Spell Turning)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_GLOBE_OF_INVULNERABILITY)  // SPWI602.SPL (Globe of Invulnerability)
	!CheckSpellState(Myself,BUFF_PRO_SPELLS)
	!CheckStatGT(Myself,0,MINORGLOBE)
	!CheckStatGT(Myself,0,SHIELDGLOBE)
	OR(5)
		See([EVILCUTOFF.0.0.MAGE_ALL])
		See([EVILCUTOFF.0.0.CLERIC_ALL])
		See([EVILCUTOFF.0.0.DRUID_ALL])
		See([EVILCUTOFF.0.0.BARD_ALL])
		See([EVILCUTOFF.0.0.SORCERER])
	!HasBounceEffects(Myself)
	!HasImmunityEffects(Myself)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_GLOBE_OF_INVULNERABILITY)  // SPWI602.SPL (Globe of Invulnerability)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MINOR_GLOBE_OF_INVULNERABILITY)  // SPWI406.SPL (Minor Globe of Invulnerability)
	OR(4)
		See([EVILCUTOFF.0.0.BARD_ALL])
		See([EVILCUTOFF.0.0.DRUID_ALL])
		See([EVILCUTOFF.0.0.CLERIC_ALL])
		See([EVILCUTOFF.0.0.MAGE_ALL])
	CheckStat(Myself,0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MINOR_GLOBE_OF_INVULNERABILITY)  // SPWI406.SPL (Minor Globe of Invulnerability)
END

//------------------------
// RUN AWAY FROM ATTACKER
//------------------------

// Attacked by enemy
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	HPPercentLT(Myself,61)
	See(LastAttackerOf(Myself))
	OR(2)
		HPPercentLT(Myself,41)
		!Global("BDU_Protector","LOCALS",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		DisplayStringHead(Myself,13246)  // "Get away from me!"
		RunAwayFrom(LastSeenBy(Myself),60)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
		SetInterrupt(TRUE)
END

// Attacked by friendly
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	HPPercentLT(Myself,100)
	OR(2)
		AttackedBy([GOODCUTOFF],DEFAULT)
		AttackedBy([GOODBUTRED],DEFAULT)
	See(LastAttackerOf(Myself))
	OR(2)
		HPPercentLT(Myself,41)
		!Global("BDU_Protector","LOCALS",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		DisplayStringHead(Myself,13246)  // "Get away from me!"
		RunAwayFrom(LastSeenBy(Myself),90)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
		SetInterrupt(TRUE)
END
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	HPPercentLT(Myself,91)
	AttackedBy([EVILBUTGREEN],DEFAULT)
	See(LastAttackerOf(Myself))
	OR(2)
		HPPercentLT(Myself,41)
		!Global("BDU_Protector","LOCALS",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		DisplayStringHead(Myself,13246)  // "Get away from me!"
		RunAwayFrom(LastSeenBy(Myself),45)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
		SetInterrupt(TRUE)
END

//---------------------------------------
// CONDITIONALLY RUN AWAY FROM CREATURES
//---------------------------------------

// Mind Flayer with low intelligence
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	CheckStatLT(Myself,11,INT)
	See([EVILCUTOFF.0.MIND_FLAYER])
	Range(LastSeenBy(Myself),10)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		RunAwayFrom(LastSeenBy(Myself),60)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",TWO_ROUNDS)
		SetInterrupt(TRUE)
END

// Vampire with low levels
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	CheckStatLT(Myself,5,LEVEL)
	CheckStat(Myself,0,LEVEL_DRAIN_IMMUNITY)
	See([EVILCUTOFF.0.VAMPIRE])
	Range(LastSeenBy(Myself),10)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		RunAwayFrom(LastSeenBy(Myself),60)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",TWO_ROUNDS)
		SetInterrupt(TRUE)
END

//-----------------------------
// STAY OUT OF MELEE IF RANGED
//-----------------------------

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	CanEquipRanged()
	Range(NearestEnemyOf(Myself),4)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		RunAwayFrom(NearestEnemyOf(Myself),60)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
		SetInterrupt(TRUE)
END
		
//----------------
// MOVE TO HEALER
//----------------

IF
	Global("BDU_MoveToHealer","LOCALS",1)
	OR(6)
		!Global("BDU_InCombat","GLOBAL",1)
		!GlobalTimerNotExpired("BDU_MoveTimer","LOCALS")
		Range([PC.0.0.CLERIC_ALL],5)
		Range([PC.0.0.DRUID_ALL],5)
		Range([PC.0.0.SHAMAN],5)
		!HPPercentLT(Myself,61)
THEN
	RESPONSE #100
		SetGlobal("BDU_MoveToHealer","LOCALS",0)
		SetGlobal("BDU_MoveTimer","LOCALS",0)
		ClearActions(Myself)
END

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToHealer","LOCALS",1)
	HPPercentLT(Myself,61)
	OR(2)
		HPPercentLT(Myself,41)
		!Global("BDU_Protector","LOCALS",1)
	See([PC.0.0.CLERIC_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	!StateCheck(LastSeenBy(Myself),STATE_STUNNED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!Range(LastSeenBy(Myself),5)
THEN
	RESPONSE #100
		MoveToObject(LastSeenBy(Myself))
		DisplayStringHead(Myself,3747)  // "I am wounded."
		SetGlobal("BDU_MoveToHealer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",TWO_ROUNDS)
END
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToHealer","LOCALS",1)
	HPPercentLT(Myself,61)
	OR(2)
		HPPercentLT(Myself,41)
		!Global("BDU_Protector","LOCALS",1)
	See([PC.0.0.DRUID_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	!StateCheck(LastSeenBy(Myself),STATE_STUNNED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!Range(LastSeenBy(Myself),5)
THEN
	RESPONSE #100
		MoveToObject(LastSeenBy(Myself))
		DisplayStringHead(Myself,3747)  // "I am wounded."
		SetGlobal("BDU_MoveToHealer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",TWO_ROUNDS)
END
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToHealer","LOCALS",1)
	HPPercentLT(Myself,61)
	OR(2)
		HPPercentLT(Myself,41)
		!Global("BDU_Protector","LOCALS",1)
	See([PC.0.0.SHAMAN])
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	!StateCheck(LastSeenBy(Myself),STATE_STUNNED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!Range(LastSeenBy(Myself),5)
THEN
	RESPONSE #100
		MoveToObject(LastSeenBy(Myself))
		DisplayStringHead(Myself,3747)  // "I am wounded."
		SetGlobal("BDU_MoveToHealer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",TWO_ROUNDS)
END

//-----------
// CURE SELF
//-----------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	OR(3)
		StateCheck(Myself,STATE_BLIND)
		CheckSpellState(Myself,DISEASED)
		CheckSpellState(Myself,DEAFENED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	OR(3)
		StateCheck(Myself,STATE_BLIND)
		CheckSpellState(Myself,DISEASED)
		CheckSpellState(Myself,DEAFENED)
	HPPercentLT(Myself,95)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	OR(4)
		StateCheck(Myself,STATE_FEEBLEMINDED)
		StateCheck(Myself,STATE_BLIND)
		CheckSpellState(Myself,DISEASED)
		CheckSpellState(Myself,DEAFENED)
	HPPercentLT(Myself,80)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_HEAL)  // SPPR607.SPL (Heal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	OR(3)
		CheckStatGT(Myself,0,LEVELDRAIN)
		StateCheck(Myself,STATE_FEEBLEMINDED)
		CheckSpellState(Myself,DISEASED)
	HPPercentLT(Myself,80)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatGT(Myself,0,LEVELDRAIN)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
END

//---------
// STEALTH
//---------

IF
	OR(2)
		Global("BDAI_SKILL_MODE","LOCALS",2)
		Global("BDU_InCombat","GLOBAL",1)
	ActionListEmpty()
	InParty(Myself)
	!GlobalTimerNotExpired("BD_Hide","LOCALS")
	!StateCheck(Myself,STATE_INVISIBLE)
	!StateCheck(Myself,STATE_BLIND)
	!ModalState(STEALTH)
	!See([EVILCUTOFF])
	!ButtonDisabled(BUTTON_STEALTH)
	OR(3)
		Class(Myself,THIEF_ALL)
		Class(Myself,RANGER_ALL)
		Class(Myself,MONK)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Hide","LOCALS",ONE_ROUND)
		Hide()
END

//--------------------
// MOVE TO COMBAT LOS
//--------------------

IF
	Global("BDU_MoveToPlayer","LOCALS",1)
	OR(2)
		LOS(NearestEnemyOf(Myself),24)
		!GlobalTimerNotExpired("BDU_MoveTimer","LOCALS")
THEN
	RESPONSE #100
		SetGlobal("BDU_MoveToPlayer","LOCALS",0)
		SetGlobal("BDU_MoveTimer","LOCALS",0)
		ClearActions(Myself)
END

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToPlayer","LOCALS",1)
	!See(NearestEnemyOf(Myself))
	Global("BDU_P6See","GLOBAL",1)
	!Range(Player6,2)
	!StateCheck(Player6,STATE_REALLY_DEAD)
	!StateCheck(Player6,STATE_CHARMED)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		MoveToObject(Player6)
		SetGlobal("BDU_MoveToPlayer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
END

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToPlayer","LOCALS",1)
	!See(NearestEnemyOf(Myself))
	Global("BDU_P5See","GLOBAL",1)
	!Range(Player5,2)
	!StateCheck(Player5,STATE_REALLY_DEAD)
	!StateCheck(Player5,STATE_CHARMED)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		MoveToObject(Player5)
		SetGlobal("BDU_MoveToPlayer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
END

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToPlayer","LOCALS",1)
	!See(NearestEnemyOf(Myself))
	Global("BDU_P4See","GLOBAL",1)
	!Range(Player4,2)
	!StateCheck(Player4,STATE_REALLY_DEAD)
	!StateCheck(Player4,STATE_CHARMED)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		MoveToObject(Player4)
		SetGlobal("BDU_MoveToPlayer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
END

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToPlayer","LOCALS",1)
	!See(NearestEnemyOf(Myself))
	Global("BDU_P3See","GLOBAL",1)
	!Range(Player3,2)
	!StateCheck(Player3,STATE_REALLY_DEAD)
	!StateCheck(Player3,STATE_CHARMED)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		MoveToObject(Player3)
		SetGlobal("BDU_MoveToPlayer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
END

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToPlayer","LOCALS",1)
	!See(NearestEnemyOf(Myself))
	Global("BDU_P2See","GLOBAL",1)
	!Range(Player2,2)
	!StateCheck(Player2,STATE_REALLY_DEAD)
	!StateCheck(Player2,STATE_CHARMED)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		MoveToObject(Player2)
		SetGlobal("BDU_MoveToPlayer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
END

IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!GlobalTimerNotExpired("BDU_MoveRepeatTimer","LOCALS")
	!Global("BDU_MoveToPlayer","LOCALS",1)
	!See(NearestEnemyOf(Myself))
	Global("BDU_P1See","GLOBAL",1)
	!Range(Player1,2)
	!StateCheck(Player1,STATE_REALLY_DEAD)
	!StateCheck(Player1,STATE_CHARMED)
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		MoveToObject(Player1)
		SetGlobal("BDU_MoveToPlayer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
END

// Still can't see, move to enemy
IF
	!Global("BDUAI_DISABLE_MOVEMENT","LOCALS",1)
	ActionListEmpty()
	!Global("BDU_MoveToPlayer","LOCALS",1)
	Detect(NearestEnemyOf(Myself))
	!See(NearestEnemyOf(Myself))
	HPPercentGT(Myself,40)
THEN
	RESPONSE #100
		MoveToObject(NearestEnemyOf(Myself))
		SetGlobal("BDU_MoveToPlayer","LOCALS",1)
		SetGlobalTimer("BDU_MoveTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_MoveRepeatTimer","LOCALS",ONE_ROUND)
END

//-------------------
// CURE POISON PARTY
//-------------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See([PC])
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SecondNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(ThirdNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FourthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FifthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SixthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	See(MostDamagedOf([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HPPercentLT(LastSeenBy(Myself),70)
	InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HEAL)  // SPPR607.SPL (Heal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),70)
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See([PC])
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(SecondNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(ThirdNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(FourthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(FifthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(SixthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See([PC])
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(SecondNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(ThirdNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(FourthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(FifthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(SixthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

//------------
// HEAL PARTY
//------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
	HPPercentLT(MostDamagedOf([PC]),40)
	OR(2)
		HPPercentLT(Myself,71)
		HPPercentLT(SecondNearest([PC]),71)
	OR(2)
		HPPercentLT(Myself,71)
		HPPercentLT(ThirdNearest([PC]),71)
	OR(2)
		HPPercentLT(SecondNearest([PC]),71)
		HPPercentLT(ThirdNearest([PC]),71)
	Range(SecondNearest([PC]),25)
	Range(MostDamagedOf([PC]),25)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_MASS_CURE)  // SPPR514.SPL (Mass Cure)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
	HPPercentLT(MostDamagedOf([PC]),40)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_RESURRECTION)  // SPPR712.SPL (Resurrection)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	HPPercentLT(MostDamagedOf([PC]),40)
	InParty(MostDamagedOf([PC]))
	!StateCheck(MostDamagedOf([PC]),STATE_NOT_TARGETABLE)
	!StateCheck(MostDamagedOf([PC]),STATE_NOT_APPROACHABLE)
	!StateCheck(MostDamagedOf([PC]),STATE_REALLY_DEAD)
	CheckStat(MostDamagedOf([PC]),0,MINORGLOBE)
	!CheckStatGT(MostDamagedOf([PC]),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(MostDamagedOf([PC]),0,WIZARD_SPELL_TURNING)
	!CheckStat(MostDamagedOf([PC]),2,WIZARD_SPELL_TRAP)
	!CheckStat(MostDamagedOf([PC]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(MostDamagedOf([PC]),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_HEAL)  // SPPR607.SPL (Heal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HPPercentLT(MostDamagedOf([PC]),40)
	!StateCheck(MostDamagedOf([PC]),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(MostDamagedOf([PC]),STATE_CONFUSED)
	!StateCheck(MostDamagedOf([PC]),STATE_CHARMED)
	CheckStat(MostDamagedOf([PC]),0,MINORGLOBE)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),50)
	InParty(LastSeenBy(Myself))
	OR(2)
		Range(MostDamagedOf([PC]),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),PALADIN_LAY_ON_HANDS)  // SPCL211.SPL (Lay On Hands)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),40)
	InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_CRITICAL_WOUNDS)  // SPPR502.SPL (Cure Critical Wounds)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),50)
	InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_SERIOUS_WOUNDS)  // SPPR401.SPL (Cure Serious Wounds)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
	OR(3)
		Class(MostDamagedOf([PC]),FIGHTER_ALL)
		Class(MostDamagedOf([PC]),PALADIN_ALL)
		Class(MostDamagedOf([PC]),RANGER_ALL)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	HPPercentLT(MostDamagedOf([PC]),60)
	!StateCheck(MostDamagedOf([PC]),STATE_NOT_TARGETABLE)
	!CheckStatGT(MostDamagedOf([PC]),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(MostDamagedOf([PC]),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(MostDamagedOf([PC]),0,WIZARD_SPELL_TRAP)
	!CheckStat(MostDamagedOf([PC]),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(MostDamagedOf([PC]),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),60)
	InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_MEDIUM_WOUNDS)  // SPPR315.SPL (Cure Medium Wounds)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	HPPercentLT(MostDamagedOf([PC]),70)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(MostDamagedOf([PC]),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN101")  // Cure Light Wounds
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),70)
	InParty(LastSeenBy(Myself))
	OR(2)
		Range(MostDamagedOf([PC]),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN101",LastSeenBy(Myself))  // Cure Light Wounds
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
	See(MostDamagedOf([PC]))
	HPPercentLT(LastSeenBy(Myself),70)
	InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_LIGHT_WOUNDS)  // SPPR103.SPL (Cure Light Wounds)
		SetInterrupt(TRUE)
END

//------------
// CURE PARTY
//------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HEAL)  // SPPR607.SPL (Heal)
	See(MostDamagedOf([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HPPercentLT(LastSeenBy(Myself),50)
	InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HEAL)  // SPPR607.SPL (Heal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See([PC])
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SecondNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(ThirdNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FourthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FifthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SixthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CURE_DISEASE)  // SPPR317.SPL (Cure Disease)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See([PC])
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SecondNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(ThirdNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FourthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FifthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SixthNearest([PC]))
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_POISONED)
		StateCheck(LastSeenBy(Myself),STATE_BLIND)
		CheckSpellState(LastSeenBy(Myself),DISEASED)
		CheckSpellState(LastSeenBy(Myself),DEAFENED)
	HaveSpell(CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEUTRALIZE_POISON)  // SPPR404.SPL (Neutralize Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See([PC])
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SecondNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(ThirdNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FourthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FifthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SixthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_RESTORATION)  // SPPR713.SPL (Greater Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See([PC])
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(SecondNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(ThirdNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(FourthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(FifthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN102")  // Slow Poison
	See(SixthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	OR(2)
		Range(LastSeenBy(Myself),6)
		!Range(NearestEnemyOf(Myself),30)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN102",LastSeenBy(Myself))  // Slow Poison
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See([PC])
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(SecondNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(ThirdNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(FourthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(FifthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
	See(SixthNearest([PC]))
	StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_SLOW_POISON)  // SPPR212.SPL (Slow Poison)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See([PC])
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SecondNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(ThirdNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FourthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FifthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SixthNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_LESSER_RESTORATION)  // SPPR417.SPL (Lesser Restoration)
		SetInterrupt(TRUE)
END

//------------------
// UN-DISABLE PARTY
//------------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See([GOODCUTOFF])
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!GlobalTimerNotExpired("BD_RParal","LOCALS")
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_RParal","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(SecondNearest([GOODCUTOFF]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!GlobalTimerNotExpired("BD_RParal","LOCALS")
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_RParal","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(ThirdNearest([GOODCUTOFF]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!GlobalTimerNotExpired("BD_RParal","LOCALS")
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,WEB)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_RParal","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(FourthNearest([GOODCUTOFF]))
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	!GlobalTimerNotExpired("BD_RParal","LOCALS")
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_RParal","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!GlobalTimerNotExpired("BD_RParal","LOCALS")
	See(FifthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_RParal","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
	OR(2)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
	!GlobalTimerNotExpired("BD_RParal","LOCALS")
	See(SixthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStat(LastSeenBy(Myself),0,WEB)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_RParal","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_PARALYSIS)  // SPPR308.SPL (Remove Paralysis)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck([GOODCUTOFF],STATE_PANIC)
	See([GOODCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SecondNearest([GOODCUTOFF]),STATE_PANIC)
	See(SecondNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(ThirdNearest([GOODCUTOFF]),STATE_PANIC)
	See(ThirdNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FourthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FourthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FifthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FifthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SixthNearest([GOODCUTOFF]),STATE_PANIC)
	See(SixthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CAVALIER_REMOVE_FEAR)  // SPCL222.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck([GOODCUTOFF],STATE_PANIC)
	See([GOODCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SecondNearest([GOODCUTOFF]),STATE_PANIC)
	See(SecondNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(ThirdNearest([GOODCUTOFF]),STATE_PANIC)
	See(ThirdNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FourthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FourthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FifthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FifthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SixthNearest([GOODCUTOFF]),STATE_PANIC)
	See(SixthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck([GOODCUTOFF],STATE_PANIC)
	See([GOODCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SecondNearest([GOODCUTOFF]),STATE_PANIC)
	See(SecondNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(ThirdNearest([GOODCUTOFF]),STATE_PANIC)
	See(ThirdNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FourthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FourthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(FifthNearest([GOODCUTOFF]),STATE_PANIC)
	See(FifthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	StateCheck(SixthNearest([GOODCUTOFF]),STATE_PANIC)
	See(SixthNearest([GOODCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN21",Myself)  // Potion of Clarity
	!CheckSpellState(Myself,POTION_OF_CLARITY)
	CheckStat(Myself,0,CLERIC_CHAOTIC_COMMANDS)
	OR(2)
		Range([EVILCUTOFF.0.MYCONID],30)
		Range([EVILCUTOFF.0.UMBERHULK],30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN21",Myself)  // Potion of Clarity
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_SClar","LOCALS")
	See(Player1)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_SClar","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_SClar","LOCALS")
	See(Player2)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_SClar","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_SClar","LOCALS")
	See(Player3)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_SClar","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_SClar","LOCALS")
	See(Player4)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_SClar","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_SClar","LOCALS")
	See(Player5)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_SClar","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_SClar","LOCALS")
	See(Player6)
	OR(4)
		StateCheck(LastSeenBy(Myself),STATE_PANIC)
		StateCheck(LastSeenBy(Myself),STATE_CHARMED)
		StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
		StateCheck(LastSeenBy(Myself),STATE_FEEBLEMINDED)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	HaveSpell(CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_SClar","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SPIRITUAL_CLARITY)  // SPPR350.SPL (Spiritual Clarity)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_FREE_ACTION)  // SPPR403.SPL (Free Action)
	See(NearestMyGroupOfType)
	OR(7)
		Global("BDU_WebCast","GLOBAL",1)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,GREASE)
		CheckStatGT(LastSeenBy(Myself),0,WEB)
		CheckStatGT(LastSeenBy(Myself),0,ENTANGLE)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	CheckStat(Myself,0,CLERIC_FREE_ACTION)
	CheckStat(Myself,0,MINORGLOBE)
	!HasItemEquiped("RING09",Myself)  // Edventar's Gift
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FREE_ACTION)  // SPPR403.SPL (Free Action)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN45",Myself)  // Potion of Freedom
	OR(7)
		Global("BDU_WebCast","GLOBAL",1)
		CheckStatGT(LastSeenBy(Myself),0,HELD)
		CheckStatGT(LastSeenBy(Myself),0,GREASE)
		CheckStatGT(LastSeenBy(Myself),0,WEB)
		CheckStatGT(LastSeenBy(Myself),0,ENTANGLE)
		StateCheck(LastSeenBy(Myself),STATE_STUNNED)
		StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	CheckStat(Myself,0,CLERIC_FREE_ACTION)
	CheckStat(Myself,0,MINORGLOBE)
	!HasItemEquiped("RING09",Myself)  // Edventar's Gift
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN45",Myself)  // Potion of Freedom
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

//---------------
// PROTECT PARTY
//---------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	OR(5)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.0.SHADOW_DRAGON],30)
	See([PC])
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	CheckStat(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
	!HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
	!HasItemEquipedReal("HAMM10",LastSeenBy(Myself))  // Runehammer +4
	!HasItemEquipedReal("HAMM11",LastSeenBy(Myself))  // Runehammer +5
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	OR(5)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.0.SHADOW_DRAGON],30)
	See(SecondNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	CheckStat(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
	!HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
	!HasItemEquipedReal("HAMM10",LastSeenBy(Myself))  // Runehammer +4
	!HasItemEquipedReal("HAMM11",LastSeenBy(Myself))  // Runehammer +5
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
	OR(5)
		Range([EVILCUTOFF.0.0.WIGHT],30)
		Range([EVILCUTOFF.0.0.WRAITH],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
		Range([EVILCUTOFF.0.VAMPIRE],30)
		Range([EVILCUTOFF.0.0.SHADOW_DRAGON],30)
	See(ThirdNearest([PC]))
	CheckStatGT(LastSeenBy(Myself),0,LEVELDRAIN)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
	CheckStat(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
	!HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
	!HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
	!HasItemEquipedReal("HAMM10",LastSeenBy(Myself))  // Runehammer +4
	!HasItemEquipedReal("HAMM11",LastSeenBy(Myself))  // Runehammer +5
	!HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // spwi311.SPL (Protection From Normal Missiles)
	!CheckSpellState(Myself,PROTECTION_FROM_NORMAL_MISSILES)
	OR(11)
		HitBy([ANYONE],MISSILE)
		IsWeaponRanged(NearestEnemyOf(Myself))
		IsWeaponRanged(SecondNearestEnemyOf(Myself))
		IsWeaponRanged(ThirdNearestEnemyOf(Myself))
		IsWeaponRanged(FourthNearestEnemyOf(Myself))
		IsWeaponRanged(FifthNearestEnemyOf(Myself))
		IsWeaponRanged(SixthNearestEnemyOf(Myself))
		IsWeaponRanged(SeventhNearestEnemyOf(Myself))
		IsWeaponRanged(EighthNearestEnemyOf(Myself))
		IsWeaponRanged(NinthNearestEnemyOf(Myself))
		IsWeaponRanged(TenthNearestEnemyOf(Myself))
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // spwi311.SPL (Protection From Normal Missiles)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fireshield (Red))
	!CheckStat(Myself,1,WIZARD_FIRE_SHIELD)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
	OR(4)
		HitBy([ANYONE],CRUSHING)
		HitBy([ANYONE],SLASHING)
		HitBy([ANYONE],PIERCING)
		HitBy([ANYONE],FIRE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fireshield (Red))
END

//-------------
// PERFORMANCE
//-------------

IF
	OR(8)
		!InParty(Myself)
		!Allegiance(Myself,GOODCUTOFF)
		StateCheck(Myself,STATE_REALLY_DEAD)
		StateCheck(Myself,STATE_SLEEPING)
		StateCheck(Myself,STATE_PANIC)
		StateCheck(Myself,STATE_STUNNED)
		StateCheck(Myself,STATE_CHARMED)
		StateCheck(Myself,STATE_CONFUSED)
THEN
	RESPONSE #100
		NoAction()
END

IF
	ActionListEmpty()
	!Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		NoAction()
END

//-----------------------------------------
// IF IN SHAMANDANCE, STAY IN SHAMAN DANCE
//-----------------------------------------

IF
	ModalState(SHAMANDANCE)
	InParty(Myself)
THEN
	RESPONSE #100
		NoAction()
END

//---------------------
// DEFENSIVE BUFF SELF
//---------------------

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPDWD02")  // Defensive Stance
	!CheckSpellState(Myself,DEFENSIVE_STANCE)
	Range(NearestEnemyOf(Myself),6)
	OR(2)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPDWD02",Myself)  // Defensive Stance
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	Global("BDU_InCombat","GLOBAL",1)
	HaveSpell(WIZARD_SPIRIT_ARMOR)  // SPWI414.SPL (Spirit Armor)
	CheckStatGT(Myself,1,ARMORCLASS)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SPIRIT_ARMOR)  // SPWI414.SPL (Spirit Armor)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	CheckStatLT(Myself,1,STONESKINS)
	HaveSpell(WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	CheckStatLT(Myself,1,STONESKINS)
	HaveSpell(CLERIC_IRONSKIN)  // SPPR506.SPL (Iron Skins)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_IRONSKIN)  // SPPR506.SPL (Iron Skins)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PROTECTION_FROM_EVIL)  // SPWI113.SPL (Protection From Evil)
	NumCreatureGT([EVILCUTOFF],3)
	See([0.0.DEMONIC.0.0.SUMMONED_DEMON])
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_PROTECTION_FROM_EVIL)  // SPWI113.SPL (Protection From Evil)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
	NumCreatureGT([EVILCUTOFF],3)
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	OR(7)
		Alignment([EVILCUTOFF],MASK_EVIL)
		Alignment(SecondNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(ThirdNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FourthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FifthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(SixthNearest([EVILCUTOFF]),MASK_EVIL)
		Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
	NumCreatureGT([EVILCUTOFF],3)
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	OR(7)
		Alignment([EVILCUTOFF],MASK_EVIL)
		Alignment(SecondNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(ThirdNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FourthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FifthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(SixthNearest([EVILCUTOFF]),MASK_EVIL)
		Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_ARMOR)  // SPWI102.SPL (Armor)
	CheckStatGT(Myself,6,ARMORCLASS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_ARMOR)  // SPWI102.SPL (Armor)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
	CheckStatLT(Myself,20,DAMAGELUCK)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_DHarm","LOCALS")
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
	NumCreatureGT([EVILCUTOFF],3)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStat(Myself,0,CLERIC_DEFENSIVE_HARMONY)
	Global("BDU_InCombat","GLOBAL",1)
	Range([GOODCUTOFF],12)
	Range(SecondNearest([GOODCUTOFF]),12)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DHarm","LOCALS",THREE_ROUNDS)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
	Global("BDU_InCombat","GLOBAL",1)
	OR(2)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
	!CheckSpellState(Myself,ARMOR_OF_FAITH)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN103")  // Draw Upon Holy Might
	Global("BDU_InCombat","GLOBAL",1)
	OR(2)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN103",Myself)  // Draw Upon Holy Might
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
	Global("BDU_InCombat","GLOBAL",1)
	OR(2)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
	!StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BLUR)  // SPWI201.SPL (Blur)
	!StateCheck(Myself,STATE_BLUR)
	NumCreatureGT([EVILCUTOFF],3)
	!CheckStatGT(NearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SecondNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(ThirdNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(FourthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SixthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(SeventhNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(EighthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(NinthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT(TenthNearestEnemyOf(Myself),0,TRUE_SIGHT)
	!CheckStatGT([EVILCUTOFF.0.PLANATAR],0,TRUE_SIGHT)
	!CheckStatGT([EVILCUTOFF.0.DARKPLANATAR],0,TRUE_SIGHT)
	!CheckStat(Myself,1,PUPPETTYPE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_BLUR)  // SPWI201.SPL (Blur)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SHIELD)  // SPWI114.SPL (Shield)
	Global("BDU_MagicMissileCast","GLOBAL",1)
	!CheckStat(Myself,2,DEFENSIVE_MODIFIER)
	CheckStat(Myself,0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SHIELD)  // SPWI114.SPL (Shield)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SHIELD)  // SPWI114.SPL (Shield)
	OR(11)
		HitBy([ANYONE],MISSILE)
		IsWeaponRanged(NearestEnemyOf(Myself))
		IsWeaponRanged(SecondNearestEnemyOf(Myself))
		IsWeaponRanged(ThirdNearestEnemyOf(Myself))
		IsWeaponRanged(FourthNearestEnemyOf(Myself))
		IsWeaponRanged(FifthNearestEnemyOf(Myself))
		IsWeaponRanged(SixthNearestEnemyOf(Myself))
		IsWeaponRanged(SeventhNearestEnemyOf(Myself))
		IsWeaponRanged(EighthNearestEnemyOf(Myself))
		IsWeaponRanged(NinthNearestEnemyOf(Myself))
		IsWeaponRanged(TenthNearestEnemyOf(Myself))
	!CheckStat(Myself,2,DEFENSIVE_MODIFIER)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_SHIELD)  // SPWI114.SPL (Shield)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(BLADE_DEFENSIVE_SPIN)  // SPCL522.SPL (Defensive Spin)
	!CheckSpellState(Myself,DEFENSIVE_SPIN)
	!CheckSpellState(Myself,OFFENSIVE_SPIN)
	Range(NearestEnemyOf(Myself),6)
	Range(SecondNearestEnemyOf(Myself),6)
	Range(ThirdNearestEnemyOf(Myself),6)
	Global("BDU_Protector","LOCALS",1)
	Global("BDU_InCombat","GLOBAL",1)
	NumCreatureGT([EVILCUTOFF],4)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,BLADE_DEFENSIVE_SPIN)  // SPCL522.SPL (Defensive Spin)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN28",Myself)  // Potion of Fortitude
	CheckStatLT(Myself,18,CON)
	NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN28",Myself)  // Potion of Fortitude
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

//----------------------
// DEFENSIVE BUFF PARTY
//----------------------

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_CHANT)  // SPPR203.SPL (Chant)
	!StateCheck(Myself,STATE_CHANT)
	NumCreatureGT([EVILCUTOFF],3)
	Range([EVILCUTOFF],30)
	Range([GOODCUTOFF],12)
	Range(SecondNearest([GOODCUTOFF]),12)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_CHANT)  // SPPR203.SPL (Chant)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_BLESS)  // SPPR101.SPL (Bless)
	NumCreatureGT([EVILCUTOFF],3)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	Range([EVILCUTOFF],30)
	Range([GOODCUTOFF],15)
	Range(SecondNearest([GOODCUTOFF]),15)
	!StateCheck(Myself,STATE_BLESS)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_BLESS)  // SPPR101.SPL (Bless)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
	Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	OR(2)
		CheckStat([GOODCUTOFF],0,PROTECTION_FROM_EVIL)
		CheckStat(SecondNearest([GOODCUTOFF]),0,PROTECTION_FROM_EVIL)
	OR(2)
		Range([GOODCUTOFF],12)
		Range(SecondNearest([GOODCUTOFF]),12)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
	NumCreatureGT([EVILCUTOFF],3)
	CheckStat(Myself,0,PROTECTION_FROM_EVIL)
	OR(7)
		Alignment([EVILCUTOFF],MASK_EVIL)
		Alignment(SecondNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(ThirdNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FourthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FifthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(SixthNearest([EVILCUTOFF]),MASK_EVIL)
		Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	OR(2)
		CheckStat([GOODCUTOFF],0,PROTECTION_FROM_EVIL)
		CheckStat(SecondNearest([GOODCUTOFF]),0,PROTECTION_FROM_EVIL)
	OR(2)
		Range([GOODCUTOFF],12)
		Range(SecondNearest([GOODCUTOFF]),12)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(Myself,CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
	NumCreatureGT([EVILCUTOFF],3)
	See([PC])
	CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(7)
		Alignment([EVILCUTOFF],MASK_EVIL)
		Alignment(SecondNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(ThirdNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FourthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FifthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(SixthNearest([EVILCUTOFF]),MASK_EVIL)
		Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
	NumCreatureGT([EVILCUTOFF],3)
	See(SecondNearest([PC]))
	CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(7)
		Alignment([EVILCUTOFF],MASK_EVIL)
		Alignment(SecondNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(ThirdNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FourthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FifthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(SixthNearest([EVILCUTOFF]),MASK_EVIL)
		Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
	NumCreatureGT([EVILCUTOFF],3)
	See(ThirdNearest([PC]))
	CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!StateCheck(LastSeenBy(Myself),STATE_CONFUSED)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	OR(7)
		Alignment([EVILCUTOFF],MASK_EVIL)
		Alignment(SecondNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(ThirdNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FourthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(FifthNearest([EVILCUTOFF]),MASK_EVIL)
		Alignment(SixthNearest([EVILCUTOFF]),MASK_EVIL)
		Range([0.0.DEMONIC.0.0.SUMMONED_DEMON],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Support","LOCALS")
	HaveSpell(CLERIC_BARKSKIN)  // SPPR202.SPL (Barkskin)
	NumCreatureGT([EVILCUTOFF],3)
	See(WorstAC([PC]))
	!CheckSpellState(WorstAC([PC]),BARKSKIN)
	CheckStatGT(WorstAC([PC]),4,ARMORCLASS)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Support","LOCALS",TWO_ROUNDS)
		Spell(WorstAC([PC]),CLERIC_BARKSKIN)  // SPPR202.SPL (Barkskin)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN24",Myself)  // Potion of Defense
	CheckStatGT(Myself,0,ARMORCLASS)
	CheckStatLT(Myself,1,STONESKINS)
	NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN24",Myself)  // Potion of Defense
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Haste","LOCALS")
	HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
	NumCreatureGT([EVILCUTOFF],3)
	See([GOODCUTOFF.0.0.FIGHTER_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HASTED)
	CheckStat(LastSeenBy(Myself),0,IMPROVEDHASTE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Haste","LOCALS",THREE_ROUNDS)
		Spell([GOODCUTOFF.0.0.FIGHTER_ALL],WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Haste","LOCALS")
	HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
	NumCreatureGT([EVILCUTOFF],3)
	See([GOODCUTOFF.0.0.RANGER_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HASTED)
	CheckStat(LastSeenBy(Myself),0,IMPROVEDHASTE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Haste","LOCALS",THREE_ROUNDS)
		Spell([GOODCUTOFF.0.0.RANGER_ALL],WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Haste","LOCALS")
	HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
	NumCreatureGT([EVILCUTOFF],3)
	See([GOODCUTOFF.0.0.PALADIN_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HASTED)
	CheckStat(LastSeenBy(Myself),0,IMPROVEDHASTE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Haste","LOCALS",THREE_ROUNDS)
		Spell([GOODCUTOFF.0.0.PALADIN_ALL],WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Haste","LOCALS")
	HaveSpell(WIZARD_HASTE)  // SPWI305.SPL (Haste)
	NumCreatureGT([EVILCUTOFF],3)
	See([GOODCUTOFF.0.0.FIGHTER_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HASTED)
	CheckStat(LastSeenBy(Myself),0,IMPROVEDHASTE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Haste","LOCALS",THREE_ROUNDS)
		Spell([GOODCUTOFF.0.0.FIGHTER_ALL],WIZARD_HASTE)  // SPWI305.SPL (Haste)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Haste","LOCALS")
	HaveSpell(WIZARD_HASTE)  // SPWI305.SPL (Haste)
	NumCreatureGT([EVILCUTOFF],3)
	See([GOODCUTOFF.0.0.RANGER_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HASTED)
	CheckStat(LastSeenBy(Myself),0,IMPROVEDHASTE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Haste","LOCALS",THREE_ROUNDS)
		Spell([GOODCUTOFF.0.0.RANGER_ALL],WIZARD_HASTE)  // SPWI305.SPL (Haste)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Haste","LOCALS")
	HaveSpell(WIZARD_HASTE)  // SPWI305.SPL (Haste)
	NumCreatureGT([EVILCUTOFF],3)
	See([GOODCUTOFF.0.0.PALADIN_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_HASTED)
	CheckStat(LastSeenBy(Myself),0,IMPROVEDHASTE)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Haste","LOCALS",THREE_ROUNDS)
		Spell([GOODCUTOFF.0.0.PALADIN_ALL],WIZARD_HASTE)  // SPWI305.SPL (Haste)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN828")  // Haste
	NumCreatureGT([EVILCUTOFF],3)
	!StateCheck(Myself,STATE_HASTED)
	!CheckStat(Myself,0,IMPROVEDHASTE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN828",Myself)  // Haste
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN14",Myself)  // Oil of Speed
	!StateCheck(Myself,STATE_HASTED)
	NumCreatureGT([EVILCUTOFF],4)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN14",Myself)  // Oil of Speed
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	!ModalState(SHAMANDANCE)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_SWard","LOCALS")
	HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
	!CheckSpellState(Myself,SPIRIT_WARD)
	OR(7)
		Range([EVILCUTOFF.0.ELEMENTAL],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.SHADOW],30)
		Range([EVILCUTOFF.0.SPECTRE],30)
		Range([EVILCUTOFF.0.WRAITH],30)
		Range([EVILCUTOFF.0.SPECTRAL_UNDEAD],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_SWard","LOCALS",THREE_ROUNDS)
		Spell(Myself,CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	!ModalState(SHAMANDANCE)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_SWard","LOCALS")
	HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
	OR(7)
		Range([EVILCUTOFF.0.ELEMENTAL],30)
		Range([EVILCUTOFF.0.FAIRY],30)
		Range([EVILCUTOFF.0.SHADOW],30)
		Range([EVILCUTOFF.0.SPECTRE],30)
		Range([EVILCUTOFF.0.WRAITH],30)
		Range([EVILCUTOFF.0.SPECTRAL_UNDEAD],30)
		Range([EVILCUTOFF.0.0.SPECTRE],30)
	See([PC])
	!CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_SWard","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_STRENGTH_OF_ONE)  // SPPR312.SPL (Strength of One)
	Range(NearestEnemyOf(Myself),30)
	Range(FourthNearestAllyOf(Myself),15)
	CheckStatLT(NearestAllyOf(Myself),18,STR)
	CheckStatLT(SecondNearestAllyOf(Myself),18,STR)
	CheckStatLT(ThirdNearestAllyOf(Myself),18,STR)
	CheckStatLT(FourthNearestAllyOf(Myself),18,STR)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_STRENGTH_OF_ONE)  // SPPR312.SPL (Strength of One)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See([PC.0.0.FIGHTER_ALL])
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([PC.0.0.FIGHTER_ALL],WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([PC.0.0.FIGHTER_ALL]))
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([PC.0.0.FIGHTER_ALL]),WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See([PC.0.0.PALADIN_ALL])
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([PC.0.0.PALADIN_ALL],WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([PC.0.0.PALADIN_ALL]))
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([PC.0.0.PALADIN_ALL]),WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See([PC.0.0.MONK])
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([PC.0.0.MONK],WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([PC.0.0.MONK]))
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([PC.0.0.MONK]),WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See([PC.0.0.RANGER_ALL])
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([PC.0.0.RANGER_ALL],WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([PC.0.0.RANGER_ALL]))
	CheckStatLT(LastSeenBy(Myself),18,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([PC.0.0.RANGER_ALL]),WIZARD_STRENGTH)  // SPWI214.SPL (Strength)
END

//------------------
// INVISIBLE DETECT
//------------------

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	Global("BDU_InvisibilityCast","GLOBAL",1)
	Global("BDU_InCombat","GLOBAL",1)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobal("BDU_InvisibilityCast","GLOBAL",0)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	See([EVILCUTOFF.0.0.0.0.ILLUSIONARY])
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobal("BDU_InvisibilityCast","GLOBAL",0)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	See(NearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobal("BDU_InvisibilityCast","GLOBAL",0)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	See(SecondNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobal("BDU_InvisibilityCast","GLOBAL",0)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	See(ThirdNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	See(FourthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	See(FifthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
	See(SixthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,INQUIS_TRUE_SIGHT)  // SPCL232.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	Global("BDU_InvisibilityCast","GLOBAL",1)
	Global("BDU_InCombat","GLOBAL",1)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	See([EVILCUTOFF.0.0.0.0.ILLUSIONARY])
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	See(NearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	See(SecondNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	See(ThirdNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	See(FourthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	See(FifthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
	See(SixthNearestEnemyOf(Myself))
	OR(3)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TRUE_SIGHT)  // SPWI609.SPL (True Sight)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	Global("BDU_InvisibilityCast","GLOBAL",1)
	Global("BDU_InCombat","GLOBAL",1)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	See(NearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	See(NearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	See(SecondNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	See(ThirdNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	See(FourthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	See(FifthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END

IF
	Global("BDAI_DISABLE_DEFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
	!GlobalTimerNotExpired("BD_DInv","LOCALS")
	See(SixthNearestEnemyOf(Myself))
	StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	!StateCheck(LastSeenBy(Myself),STATE_NONDETECTION)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_DInv","LOCALS",TWO_ROUNDS)
		Spell(Myself,WIZARD_DETECT_INVISIBILITY)  // SPWI203.SPL (Detect Invisibility)
END


IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
	Detect([EVILCUTOFF])
	OR(6)
		!See(LastSeenBy(Myself))
		Global("BDU_InvisibilityCast","GLOBAL",1)
		StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_BLUR)
		Gender(LastSeenBy(Myself),ILLUSIONARY)
	CheckStatLT(LastSeenBy(Myself),80,STEALTH)
	CheckStat(Myself,0,TRUE_SIGHT)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_TRUE_SIGHT)  // SPPR505.SPL (True Seeing)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Glitter","LOCALS")
	HaveSpell(WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
	NumCreatureGT([EVILCUTOFF],2)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	!CheckSpellState(LastSeenBy(Myself),GLITTERDUST)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Glitter","LOCALS",TWO_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Glitter","LOCALS")
	HaveSpell(WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	!CheckSpellState(LastSeenBy(Myself),GLITTERDUST)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Glitter","LOCALS",TWO_ROUNDS)
		Spell(SecondNearestEnemyOf(Myself),WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Glitter","LOCALS")
	HaveSpell(WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	!CheckSpellState(LastSeenBy(Myself),GLITTERDUST)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Glitter","LOCALS",TWO_ROUNDS)
		Spell(ThirdNearestEnemyOf(Myself),WIZARD_GLITTERDUST)  // SPWI224.SPL (Glitterdust)
END

//-----------
// SUMMONING
//-----------

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_SUMMON_HAKEASHAR)  // SPWI719.SPL (Summon Hakeashar)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	OR(4)
		Range([EVILCUTOFF.0.0.MAGE_ALL],30)
		Range([EVILCUTOFF.0.0.BARD_ALL],30)
		Range([EVILCUTOFF.0.0.CLERIC_ALL],30)
		Range([EVILCUTOFF.0.0.DRUID_ALL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_SUMMON_HAKEASHAR)  // SPWI719.SPL (Summon Hakeashar)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_MORDENKAINENS_SWORD)  // SPWI716.SPL (Mordenkainen's Sword)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_MORDENKAINENS_SWORD)  // SPWI716.SPL (Mordenkainen's Sword)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_SUMMON_NISHRUU)  // SPWI624.SPL (Summon Nishruu)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	OR(4)
		Range([EVILCUTOFF.0.0.MAGE_ALL],30)
		Range([EVILCUTOFF.0.0.BARD_ALL],30)
		Range([EVILCUTOFF.0.0.CLERIC_ALL],30)
		Range([EVILCUTOFF.0.0.DRUID_ALL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(Myself,WIZARD_SUMMON_NISHRUU)  // SPWI624.SPL (Summon Nishruu)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(CLERIC_CONJURE_FIRE_ELEMENTAL)  // SPPR605.SPL (Conjure Fire Elemental)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),CLERIC_CONJURE_FIRE_ELEMENTAL)  // SPPR605.SPL (Conjure Fire Elemental)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(CLERIC_ANIMATE_DEAD)  // SPPR301.SPL (Animate Dead)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),CLERIC_ANIMATE_DEAD)  // SPPR301.SPL (Animate Dead)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_ANIMATE_DEAD)  // SPWI501.SPL (Animate Dead)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_ANIMATE_DEAD)  // SPWI501.SPL (Animate Dead)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_MONSTER_SUMMONING_3)  // SPWI504.SPL (Monster Summoning III)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_MONSTER_SUMMONING_3)  // SPWI504.SPL (Monster Summoning III)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_SPIDER_SPAWN)  // SPWI423.SPL (Spider Spawn)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_SPIDER_SPAWN)  // SPWI423.SPL (Spider Spawn)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Wand","LOCALS")
	HasItem("WAND10",Myself)  // Wand of Monster Summoning
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Wand","LOCALS",THREE_ROUNDS)
		DisplayStringHead(Myself,31971)  // *uses a wand*
		UseItem("WAND10",NearestEnemyOf(Myself))  // Wand of Monster Summoning
		SetSequence(SEQ_CAST)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_MONSTER_SUMMONING_2)  // SPWI407.SPL (Monster Summoning II)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_MONSTER_SUMMONING_2)  // SPWI407.SPL (Monster Summoning II)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Summon","LOCALS")
	HaveSpell(WIZARD_MONSTER_SUMMONING_1)  // SPWI309.SPL (Monster Summoning I)
	NumCreatureLT([GOODCUTOFF.0.0.0.0.SUMMONED],3)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	Range(NearestEnemyOf(Myself),30)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Summon","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_MONSTER_SUMMONING_1)  // SPWI309.SPL (Monster Summoning I)
END

//-------------
// TURN UNDEAD
//-------------

IF
	ActionListEmpty()
	InParty(Myself)
	!ModalState(TURNUNDEAD)
	Range([EVILCUTOFF.UNDEAD],12)
	OR(2)
		CanTurn([EVILCUTOFF.UNDEAD],5)
		CanTurn(SecondNearest([EVILCUTOFF.UNDEAD]),5)
	OR(2)
		CanTurn(ThirdNearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(FourthNearest([EVILCUTOFF.UNDEAD]),5)
	OR(2)
		CanTurn(FifthNearest([EVILCUTOFF.UNDEAD]),5)
		CanTurn(SixthNearest([EVILCUTOFF.UNDEAD]),5)
	!ButtonDisabled(BUTTON_TURNUNDEAD)
THEN
	RESPONSE #100
		Turn()
END

//---------------------
// BREAK THROUGH MAGIC
//---------------------

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),5)
	OR(5)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),5)
	OR(5)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BREACH)  // SPWI513.SPL (Breach)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),5)
	OR(5)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_MAGICAL_WEAPONS)
		CheckSpellState(LastSeenBy(Myself),MANTLE)
		CheckSpellState(LastSeenBy(Myself),IMPROVED_MANTLE)
		CheckSpellState(LastSeenBy(Myself),ABSOLUTE_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BREACH)  // SPWI513.SPL (Breach)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),9)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_STRIKE)  // SPWI903.SPL (Spellstrike)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),3)
	OR(4)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
		CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SPELL_THRUST)  // SPWI321.SPL (Spell Thrust)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RUBY_RAY_OF_REVERSAL)  // SPWI704.SPL (Ruby Ray of Reversal)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),8)
	OR(6)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
		CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_SHIELD)  // SPWI805.SPL (Pierce Shield)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),7)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_WARDING_WHIP)  // SPWI705.SPL (Khelben's Warding Whip)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),6)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_PIERCE_MAGIC)  // SPWI608.SPL (Pierce Magic)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See([EVILCUTOFF])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See(SecondNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
	See(ThirdNearest([EVILCUTOFF]))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!ImmuneToSpellLevel(LastSeenBy(Myself),4)
	OR(5)
		CheckStat(LastSeenBy(Myself),1,MINORGLOBE)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_SHIELD_OF_THE_ARCHONS)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_SECRET_WORD)  // SPWI419.SPL (Secret Word)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	OR(4)
		See([EVILCUTOFF.0.0.BARD_ALL])
		See([EVILCUTOFF.0.0.DRUID_ALL])
		See([EVILCUTOFF.0.0.CLERIC_ALL])
		See([EVILCUTOFF.0.0.MAGE_ALL])
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	OR(4)
		See(SecondNearest([EVILCUTOFF.0.0.BARD_ALL]))
		See(SecondNearest([EVILCUTOFF.0.0.DRUID_ALL]))
		See(SecondNearest([EVILCUTOFF.0.0.CLERIC_ALL]))
		See(SecondNearest([EVILCUTOFF.0.0.MAGE_ALL]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	OR(4)
		See(ThirdNearest([EVILCUTOFF.0.0.BARD_ALL]))
		See(ThirdNearest([EVILCUTOFF.0.0.DRUID_ALL]))
		See(ThirdNearest([EVILCUTOFF.0.0.CLERIC_ALL]))
		See(ThirdNearest([EVILCUTOFF.0.0.MAGE_ALL]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(NearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(ThirdNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(FourthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(FifthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Displ","LOCALS")
	HaveSpell(WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SixthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),34,LEVEL3)
	!CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_IMMUNITY)
	OR(18)
		StateCheck(LastSeenBy(Myself),STATE_MIRRORIMAGE)
		StateCheck(LastSeenBy(Myself),STATE_HASTED)
		CheckStatGT(LastSeenBy(Myself),0,TRUE_SIGHT)
		CheckStatGT(LastSeenBy(Myself),0,STONESKINS)
		CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_DEFENSIVE_HARMONY)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
		CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
		CheckStatGT(LastSeenBy(Myself),0,WIZARD_FIRE_SHIELD)
		CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
		CheckStatGT(LastSeenBy(Myself),0,DEFENSIVE_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),0,STRENGTH_MODIFIER)
		CheckStatGT(LastSeenBy(Myself),3,WIZARD_PROTECTION_FROM_MAGIC_WEAPONS)
		HasItemEquiped("BLAKBLAD",LastSeenBy(Myself))  // Black Blade of Disaster
		HasItemEquiped("HARM",LastSeenBy(Myself))  // Harm
		HasItemEquiped("SLAYLIVE",LastSeenBy(Myself))  // Slay Living
		HasItemEquiped("MELFMET",LastSeenBy(Myself))  // Melf's Minute Meteor
		HasItem("NISHRUU",LastSeenBy(Myself))  // Attack
	!StateCheck(NearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(SeventhNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(EighthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(NinthNearestEnemyOf(Myself),STATE_DISABLED)
	!StateCheck(TenthNearestEnemyOf(Myself),STATE_DISABLED)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Displ","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_REMOVE_MAGIC)  // SPWI302.SPL (Remove Magic)
END

//---------------------------
// PREP FOR OFFENSIVE SPELLS
//---------------------------

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See([EVILCUTOFF])
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Range(LastSeenBy(Myself),8)
	CheckStatGT(LastSeenBy(Myself),49,RESISTMAGIC)
	HaveSpell(WIZARD_LOWER_RESISTANCE)  // SPWI514.SPL (Lower Resistance)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_LOWER_RESISTANCE)  // SPWI514.SPL (Lower Resistance)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Malison","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
	See(NearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Malison","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Malison","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
	See(SecondNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Malison","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Malison","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
	See(ThirdNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Malison","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Malison","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
	See(FourthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Malison","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Malison","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
	See(FifthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Malison","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Malison","LOCALS")
	HaveSpell(WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
	See(SixthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),MALISON)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Malison","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_GREATER_MALISON)  // SPWI412.SPL (Greater Malison)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Doom","LOCALS")
	HaveSpell(CLERIC_DOOM)  // SPPR113.SPL (Doom)
	See([EVILCUTOFF])
	!CheckSpellState(LastSeenBy(Myself),DOOM)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Doom","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_DOOM)  // SPPR113.SPL (Doom)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,AURACLEANSING)
		!GlobalTimerNotExpired("BDU_Pwr","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_SILENCE)  // SPWI612.SPL (Power Word, Silence)
	See([EVILCUTOFF.0.0.MAGE_ALL])
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_SILENCED)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Pwr","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_SILENCE)  // SPWI612.SPL (Power Word, Silence)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
	See([EVILCUTOFF])
	OR(5)
		Race(LastSeenBy(Myself),DRAGON)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),SORCERER)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
	See(SecondNearest([EVILCUTOFF]))
	OR(5)
		Race(LastSeenBy(Myself),DRAGON)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),SORCERER)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	See(ThirdNearest([EVILCUTOFF]))
	OR(5)
		Race(LastSeenBy(Myself),DRAGON)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),SORCERER)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
	See(FourthNearest([EVILCUTOFF]))
	OR(5)
		Race(LastSeenBy(Myself),DRAGON)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),SORCERER)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
	See(FifthNearest([EVILCUTOFF]))
	OR(5)
		Race(LastSeenBy(Myself),DRAGON)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),SORCERER)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
	See(SixthNearest([EVILCUTOFF]))
	OR(5)
		Race(LastSeenBy(Myself),DRAGON)
		Class(LastSeenBy(Myself),MAGE_ALL)
		Class(LastSeenBy(Myself),SORCERER)
		Class(LastSeenBy(Myself),CLERIC_ALL)
		Class(LastSeenBy(Myself),DRUID_ALL)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FEEBLEMIND)  // SPWI509.SPL (Feeblemind)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CREEPING_DOOM)  // SPPR717.SPL (Creeping Doom)
	See([EVILCUTOFF.0.0.MAGE_ALL])
	!See([GOODBUTRED])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CREEPING_DOOM)  // SPPR717.SPL (Creeping Doom)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CREEPING_DOOM)  // SPPR717.SPL (Creeping Doom)
	See([EVILCUTOFF.0.0.CLERIC_ALL])
	!See([GOODBUTRED])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CREEPING_DOOM)  // SPPR717.SPL (Creeping Doom)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CREEPING_DOOM)  // SPPR717.SPL (Creeping Doom)
	See([EVILCUTOFF.0.0.DRUID_ALL])
	!See([GOODBUTRED])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CREEPING_DOOM)  // SPPR717.SPL (Creeping Doom)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
	See([EVILCUTOFF.0.0.MAGE_ALL])
	!See([GOODBUTRED])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
	See([EVILCUTOFF.0.0.CLERIC_ALL])
	!See([GOODBUTRED])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
	See([EVILCUTOFF.0.0.DRUID_ALL])
	!See([GOODBUTRED])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_INSECT_PLAGUE)  // SPPR517.SPL (Insect Plague)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	!ModalState(SHAMANDANCE)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_SumIn","LOCALS")
	HaveSpell(CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
	See([EVILCUTOFF.0.0.MAGE_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSBREATH)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_SumIn","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	!ModalState(SHAMANDANCE)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_SumIn","LOCALS")
	HaveSpell(CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
	See([EVILCUTOFF.0.0.CLERIC_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSBREATH)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_SumIn","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	!ModalState(SHAMANDANCE)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_SumIn","LOCALS")
	HaveSpell(CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
	See([EVILCUTOFF.0.0.DRUID_ALL])
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_INSECT_PLAGUE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSBREATH)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_SumIn","LOCALS",THREE_ROUNDS)
		Spell(LastSeenBy(Myself),CLERIC_SUMMON_INSECTS)  // SPPR319.SPL (Summon Insects)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DEAFNESS)  // SPWI223.SPL (Deafness)
	OR(4)
		See(NearestEnemyOfType([0.0.0.MAGE_ALL]))
		See(NearestEnemyOfType([0.0.0.SORCERER]))
		See(NearestEnemyOfType([0.0.0.DRUID_ALL]))
		See(NearestEnemyOfType([0.0.0.CLERIC_ALL]))
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED_CASTING)
	CheckStatLT(LastSeenBy(Myself),50,SPELLFAILUREMAGE)
	CheckStat(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy,WIZARD_DEAFNESS)  // SPWI223.SPL (Deafness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
	See([EVILCUTOFF.0.0.FIGHTER_ALL])
	!Class(LastSeenBy(Myself),MONK)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStatLT(LastSeenBy(Myself),100,RESISTPOISON)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
	See(SecondNearest([EVILCUTOFF.0.0.FIGHTER_ALL]))
	!Class(LastSeenBy(Myself),MONK)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStatLT(LastSeenBy(Myself),100,RESISTPOISON)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
	See([EVILCUTOFF.0.0.RANGER_ALL])
	!Class(LastSeenBy(Myself),MONK)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStatLT(LastSeenBy(Myself),100,RESISTPOISON)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
	See(SecondNearest([EVILCUTOFF.0.0.RANGER_ALL]))
	!Class(LastSeenBy(Myself),MONK)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStatLT(LastSeenBy(Myself),100,RESISTPOISON)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
	See([EVILCUTOFF])
	!Class(LastSeenBy(Myself),MONK)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_POISONED)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStatLT(LastSeenBy(Myself),100,RESISTPOISON)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CONTAGION)  // SPWI409.SPL (Contagion)
END

//---------------
// CROWD CONTROL
//---------------

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHAOS)  // SPWI508.SPL (Chaos)
	NumCreatureGT([EVILCUTOFF],3)
	See([EVILCUTOFF])
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!General(LastSeenBy(Myself),PLANT)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Race(LastSeenBy(Myself),SLIME)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF],WIZARD_CHAOS)  // SPWI508.SPL (Chaos)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHAOS)  // SPWI508.SPL (Chaos)
	NumCreatureGT([EVILCUTOFF],3)
	See(SecondNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!General(LastSeenBy(Myself),PLANT)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Race(LastSeenBy(Myself),SLIME)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF]),WIZARD_CHAOS)  // SPWI508.SPL (Chaos)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHAOS)  // SPWI508.SPL (Chaos)
	NumCreatureGT([EVILCUTOFF],3)
	See(ThirdNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!General(LastSeenBy(Myself),PLANT)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Race(LastSeenBy(Myself),SLIME)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF]),WIZARD_CHAOS)  // SPWI508.SPL (Chaos)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONFUSION)  // SPWI401.SPL (Confusion)
	NumCreatureGT([EVILCUTOFF],3)
	See([EVILCUTOFF])
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!General(LastSeenBy(Myself),PLANT)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Race(LastSeenBy(Myself),SLIME)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF],WIZARD_CONFUSION)  // SPWI401.SPL (Confusion)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONFUSION)  // SPWI401.SPL (Confusion)
	NumCreatureGT([EVILCUTOFF],3)
	See(SecondNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!General(LastSeenBy(Myself),PLANT)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Race(LastSeenBy(Myself),SLIME)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF]),WIZARD_CONFUSION)  // SPWI401.SPL (Confusion)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONFUSION)  // SPWI401.SPL (Confusion)
	NumCreatureGT([EVILCUTOFF],3)
	See(ThirdNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!General(LastSeenBy(Myself),PLANT)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Race(LastSeenBy(Myself),SLIME)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF]),WIZARD_CONFUSION)  // SPWI401.SPL (Confusion)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
	NumCreatureGT([EVILCUTOFF],3)
	See([EVILCUTOFF.HUMANOID])
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_DEBUFF)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
	NumCreatureGT([EVILCUTOFF],3)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_DEBUFF)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
	NumCreatureGT([EVILCUTOFF],3)
	See(ThirdNearest([EVILCUTOFF.HUMANOID]))
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_DEBUFF)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
	NumCreatureGT([EVILCUTOFF],3)
	See(FourthNearest([EVILCUTOFF.HUMANOID]))
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_DEBUFF)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
	NumCreatureGT([EVILCUTOFF],3)
	See(FifthNearest([EVILCUTOFF.HUMANOID]))
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_DEBUFF)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
	NumCreatureGT([EVILCUTOFF],3)
	See(SixthNearest([EVILCUTOFF.HUMANOID]))
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_DEBUFF)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_EMOTION_HOPELESSNESS)  // SPWI411.SPL (Emotion: Hopelessness)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Wand","LOCALS")
	HasItem("WAND02",Myself)  // Wand of Fear
	NumCreatureGT([EVILCUTOFF],2)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),5)
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatGT(LastSeenBy(Myself),2,SAVEVSWANDS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!LevelGT(LastSeenBy(Myself),10)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Wand","LOCALS",THREE_ROUNDS)
		DisplayStringHead(Myself,31971)  // *uses a wand*
		UseItem("WAND02",LastSeenBy(Myself))  // Wand of Fear
		SetSequence(SEQ_CAST)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Wand","LOCALS")
	HasItem("WAND02",Myself)  // Wand of Fear
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),5)
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatGT(LastSeenBy(Myself),2,SAVEVSWANDS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!LevelGT(LastSeenBy(Myself),10)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Wand","LOCALS",THREE_ROUNDS)
		DisplayStringHead(Myself,31971)  // *uses a wand*
		UseItem("WAND02",LastSeenBy(Myself))  // Wand of Fear
		SetSequence(SEQ_CAST)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Wand","LOCALS")
	HasItem("WAND02",Myself)  // Wand of Fear
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),5)
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatGT(LastSeenBy(Myself),2,SAVEVSWANDS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!LevelGT(LastSeenBy(Myself),10)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Wand","LOCALS",THREE_ROUNDS)
		DisplayStringHead(Myself,31971)  // *uses a wand*
		UseItem("WAND02",LastSeenBy(Myself))  // Wand of Fear
		SetSequence(SEQ_CAST)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Horror","LOCALS")
	HaveSpellRES("SPIN105")  // Horror
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF])
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Horror","LOCALS",TWO_ROUNDS)
		SpellRES("SPIN105",[EVILCUTOFF])  // Horror
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Horror","LOCALS")
	HaveSpell(WIZARD_HORROR)  // SPWI205.SPL (Horror)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF])
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Horror","LOCALS",TWO_ROUNDS)
		Spell([EVILCUTOFF],WIZARD_HORROR)  // SPWI205.SPL (Horror)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Horror","LOCALS")
	HaveSpell(WIZARD_HORROR)  // SPWI205.SPL (Horror)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Horror","LOCALS",TWO_ROUNDS)
		Spell(SecondNearest([EVILCUTOFF]),WIZARD_HORROR)  // SPWI205.SPL (Horror)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Horror","LOCALS")
	HaveSpell(WIZARD_HORROR)  // SPWI205.SPL (Horror)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Horror","LOCALS",TWO_ROUNDS)
		Spell(ThirdNearest([EVILCUTOFF]),WIZARD_HORROR)  // SPWI205.SPL (Horror)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID.0.FIGHTER])
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID.0.FIGHTER],WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]),WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID],WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID]),WIZARD_DOMINATION)  // SPWI506.SPL (Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID.0.FIGHTER])
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID.0.FIGHTER],CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]),CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID],CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-2,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID]),CLERIC_MENTAL_DOMINATION)  // SPPR405.SPL (Mental Domination)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_DCharm","LOCALS")
	HaveSpell(WIZARD_DIRE_CHARM)  // spwi316.SPL (Dire Charm)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID.0.FIGHTER])
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_DCharm","LOCALS",THREE_ROUNDS)
		Spell([EVILCUTOFF.HUMANOID.0.FIGHTER],WIZARD_DIRE_CHARM)  // spwi316.SPL (Dire Charm)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_DCharm","LOCALS")
	HaveSpell(WIZARD_DIRE_CHARM)  // spwi316.SPL (Dire Charm)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_DCharm","LOCALS",THREE_ROUNDS)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]),WIZARD_DIRE_CHARM)  // spwi316.SPL (Dire Charm)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CONTROL_UNDEAD)  // SPWI720.SPL (Control Undead)
	See([EVILCUTOFF.UNDEAD])
	NumCreatureGT([EVILCUTOFF],2)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!CheckStatGT(LastSeenBy(Myself),0,HELD)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CONTROL_UNDEAD)  // SPWI720.SPL (Control Undead)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID.0.FIGHTER])
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID.0.FIGHTER],CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]),CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID],CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID]),CLERIC_CHARM_PERSON)  // SPPR204.SPL (Charm Person or Mammal)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID.0.FIGHTER])
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID.0.FIGHTER],WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID.0.FIGHTER]),WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID],WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Class(LastSeenBy(Myself),MONK)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),3,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID]),WIZARD_CHARM_PERSON)  // SPWI104.SPL (Charm Person)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
	NumCreatureGT([EVILCUTOFF],2)
	!Range([NEUTRAL.0.0.INNOCENT],30)
	!Range([GOODBUTBLUE],30)
	See([EVILCUTOFF.ANIMAL])
	!Race(LastSeenBy(Myself),DEMONIC)
	Range(LastSeenBy(Myself),6)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.ANIMAL],RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
	NumCreatureGT([EVILCUTOFF],2)
	!Range([NEUTRAL.0.0.INNOCENT],30)
	!Range([GOODBUTBLUE],30)
	See(SecondNearest([EVILCUTOFF.ANIMAL]))
	!Race(LastSeenBy(Myself),DEMONIC)
	Range(LastSeenBy(Myself),6)
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.ANIMAL]),RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
	NumCreatureGT([EVILCUTOFF],2)
	!Range([NEUTRAL.0.0.INNOCENT],30)
	!Range([GOODBUTBLUE],30)
	See(ThirdNearest([EVILCUTOFF.ANIMAL]))
	!Race(LastSeenBy(Myself),DEMONIC)
	Range(LastSeenBy(Myself),6)
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF.ANIMAL]),RANGER_CHARM_ANIMAL)  // SPCL311.SPL (Charm Animal)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_GREATER_COMMAND)  // SPPR512.SPL (Greater Command)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!StateCheck(LastSeenBy(Myself),STATE_SLEEPING)
	!StateCheck(LastSeenBy(Myself),STATE_STUNNED)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_GREATER_COMMAND)  // SPPR512.SPL (Greater Command)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_COMMAND)  // SPPR102.SPL (Command)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	CheckStatLT(LastSeenBy(Myself),5,LEVEL)
	CheckStatLT(LastSeenBy(Myself),5,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),5,LEVEL3)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_COMMAND)  // SPPR102.SPL (Command)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_COMMAND)  // SPPR102.SPL (Command)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	CheckStatLT(LastSeenBy(Myself),5,LEVEL)
	CheckStatLT(LastSeenBy(Myself),5,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),5,LEVEL3)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_COMMAND)  // SPPR102.SPL (Command)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_COMMAND)  // SPPR102.SPL (Command)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearest([EVILCUTOFF.HUMANOID]))
	CheckStatLT(LastSeenBy(Myself),5,LEVEL)
	CheckStatLT(LastSeenBy(Myself),5,LEVEL2)
	CheckStatLT(LastSeenBy(Myself),5,LEVEL3)
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_COMMAND)  // SPPR102.SPL (Command)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_COMMAND)  // SPPR102.SPL (Command)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_COMMAND)  // SPPR102.SPL (Command)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_COMMAND)  // SPPR102.SPL (Command)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_COMMAND)  // SPPR102.SPL (Command)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_COMMAND)  // SPPR102.SPL (Command)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearest([EVILCUTOFF.HUMANOID]))
	!Race(LastSeenBy(Myself),ELF)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_COMMAND)  // SPPR102.SPL (Command)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MAZE)  // SPWI813.SPL (Maze)
	NumCreatureGT([EVILCUTOFF],2)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),5)
	CheckStatLT(LastSeenBy(Myself),15,INT)
	HPGT(LastSeenBy(Myself),50)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!HasBounceEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(NearestEnemyOf(Myself),WIZARD_MAZE)  // SPWI813.SPL (Maze)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Wand","LOCALS")
	HasItem("WAND04",Myself)  // Wand of Paralyzation
	NumCreatureGT([EVILCUTOFF],2)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),5)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_STUNNED)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,SANCTUARY)
	CheckStatGT(LastSeenBy(Myself),9,SAVEVSWANDS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!HasItemEquipedReal("SW1H27",LastSeenBy(Myself))  // Arbane's Sword of Agility +2
	!HasItemEquipedReal("NPSW01",LastSeenBy(Myself))  // Sword of Arvoreen +2
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Wand","LOCALS",THREE_ROUNDS)
		DisplayStringHead(Myself,31971)  // *uses a wand*
		UseItem("WAND04",LastSeenBy(Myself))  // Wand of Paralyzation
		SetSequence(SEQ_CAST)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,AURACLEANSING)
		!GlobalTimerNotExpired("BDU_Pwr","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
	NumCreatureGT([EVILCUTOFF],2)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(NearestEnemyOf(Myself))
	HPLT(LastSeenBy(Myself),90)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),5,LEVEL)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquipedReal("NPSW01",LastSeenBy(Myself))  // Sword of Arvoreen +2
	!HasItemEquipedReal("SW1H27",LastSeenBy(Myself))  // Arbane's Sword of Agility +2
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Pwr","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,AURACLEANSING)
		!GlobalTimerNotExpired("BDU_Pwr","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
	NumCreatureGT([EVILCUTOFF],2)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearestEnemyOf(Myself))
	HPLT(LastSeenBy(Myself),90)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),5,LEVEL)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquipedReal("NPSW01",LastSeenBy(Myself))  // Sword of Arvoreen +2
	!HasItemEquipedReal("SW1H27",LastSeenBy(Myself))  // Arbane's Sword of Agility +2
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Pwr","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,AURACLEANSING)
		!GlobalTimerNotExpired("BDU_Pwr","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
	NumCreatureGT([EVILCUTOFF],2)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(ThirdNearestEnemyOf(Myself))
	HPLT(LastSeenBy(Myself),90)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),5,LEVEL)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquipedReal("NPSW01",LastSeenBy(Myself))  // Sword of Arvoreen +2
	!HasItemEquipedReal("SW1H27",LastSeenBy(Myself))  // Arbane's Sword of Agility +2
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Pwr","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,AURACLEANSING)
		!GlobalTimerNotExpired("BDU_Pwr","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
	NumCreatureGT([EVILCUTOFF],2)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(FourthNearestEnemyOf(Myself))
	HPLT(LastSeenBy(Myself),90)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),5,LEVEL)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquipedReal("NPSW01",LastSeenBy(Myself))  // Sword of Arvoreen +2
	!HasItemEquipedReal("SW1H27",LastSeenBy(Myself))  // Arbane's Sword of Agility +2
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Pwr","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,AURACLEANSING)
		!GlobalTimerNotExpired("BDU_Pwr","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
	NumCreatureGT([EVILCUTOFF],2)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(FifthNearestEnemyOf(Myself))
	HPLT(LastSeenBy(Myself),90)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),5,LEVEL)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquipedReal("NPSW01",LastSeenBy(Myself))  // Sword of Arvoreen +2
	!HasItemEquipedReal("SW1H27",LastSeenBy(Myself))  // Arbane's Sword of Agility +2
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Pwr","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	OR(2)
		CheckStatGT(Myself,0,AURACLEANSING)
		!GlobalTimerNotExpired("BDU_Pwr","LOCALS")
	HaveSpell(WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
	NumCreatureGT([EVILCUTOFF],2)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SixthNearestEnemyOf(Myself))
	HPLT(LastSeenBy(Myself),90)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),5,LEVEL)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquipedReal("NPSW01",LastSeenBy(Myself))  // Sword of Arvoreen +2
	!HasItemEquipedReal("SW1H27",LastSeenBy(Myself))  // Arbane's Sword of Agility +2
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Pwr","LOCALS",TWO_ROUNDS)
		Spell(LastSeenBy(Myself),WIZARD_POWER_WORD_STUN)  // SPWI715.SPL (Power Word, Stun)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_HOLD_MONSTER)  // SPWI507.SPL (Hold Monster)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF])
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_HOLD_MONSTER)  // SPWI507.SPL (Hold Monster)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!InParty(LastSeenBy(Myself))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID],WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	NumCreatureGT([EVILCUTOFF],2)
	HaveSpell(WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-1,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.HUMANOID]),WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	NumCreatureGT([EVILCUTOFF],2)
	HaveSpell(WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
	See(ThirdNearest([EVILCUTOFF.HUMANOID]))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),-1,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF.HUMANOID]),WIZARD_HOLD_PERSON)  // SPWI306.SPL (Hold Person)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.HUMANOID])
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.HUMANOID]))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearest([EVILCUTOFF.HUMANOID]))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
	NumCreatureGT([EVILCUTOFF],2)
	See(FourthNearest([EVILCUTOFF.HUMANOID]))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
	NumCreatureGT([EVILCUTOFF],2)
	See(FifthNearest([EVILCUTOFF.HUMANOID]))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
	NumCreatureGT([EVILCUTOFF],2)
	See(SixthNearest([EVILCUTOFF.HUMANOID]))
	!Kit(LastSeenBy(Myself),INQUISITOR)
	!Kit(LastSeenBy(Myself),UNDEADHUNTER)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!HasItem("MORSWORD",LastSeenBy(Myself))  // Mordenkainen's Sword
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLD_PERSON)  // SPPR208.SPL (Hold Person)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_HOLD_UNDEAD)  // SPWI324.SPL (Hold Undead)
	See([EVILCUTOFF.UNDEAD])
	NumCreatureGT([EVILCUTOFF],2)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!CheckStatGT(LastSeenBy(Myself),0,HELD)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy,WIZARD_HOLD_UNDEAD)  // SPWI324.SPL (Hold Undead)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Spook","LOCALS")
	HaveSpell(WIZARD_SPOOK)  // SPWI125.SPL (Spook)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF])
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),-3,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Spook","LOCALS",TWO_ROUNDS)
		Spell([EVILCUTOFF],WIZARD_SPOOK)  // SPWI125.SPL (Spook)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Spook","LOCALS")
	HaveSpell(WIZARD_SPOOK)  // SPWI125.SPL (Spook)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),-3,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Spook","LOCALS",TWO_ROUNDS)
		Spell(SecondNearest([EVILCUTOFF]),WIZARD_SPOOK)  // SPWI125.SPL (Spook)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Spook","LOCALS")
	HaveSpell(WIZARD_SPOOK)  // SPWI125.SPL (Spook)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearest([EVILCUTOFF]))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),TROLL)
	!Kit(LastSeenBy(Myself),CAVALIER)
	!Kit(LastSeenBy(Myself),Blackguard)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatGT(LastSeenBy(Myself),-3,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckSpellState(LastSeenBy(Myself),RESIST_FEAR)
	!CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
	!CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
	!CheckSpellState(LastSeenBy(Myself),MINSC_BERSERK)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Spook","LOCALS",TWO_ROUNDS)
		Spell(ThirdNearest([EVILCUTOFF]),WIZARD_SPOOK)  // SPWI125.SPL (Spook)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Web","LOCALS")
	HaveSpell(WIZARD_WEB)  // SPWI215.SPL (Web)
	NumCreatureGT([EVILCUTOFF],2)
	See(FarthestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(FarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(FarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobal("BDU_WebCast","GLOBAL",1)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Web","LOCALS",THREE_ROUNDS)
		Spell(FarthestEnemyOf(Myself),WIZARD_WEB)  // SPWI215.SPL (Web)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Web","LOCALS")
	HaveSpell(WIZARD_WEB)  // SPWI215.SPL (Web)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondFarthestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(SecondFarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(SecondFarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobal("BDU_WebCast","GLOBAL",1)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Web","LOCALS",THREE_ROUNDS)
		Spell(SecondFarthestEnemyOf(Myself),WIZARD_WEB)  // SPWI215.SPL (Web)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Web","LOCALS")
	HaveSpell(WIZARD_WEB)  // SPWI215.SPL (Web)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdFarthestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(ThirdFarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(ThirdFarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobal("BDU_WebCast","GLOBAL",1)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Web","LOCALS",THREE_ROUNDS)
		Spell(ThirdFarthestEnemyOf(Myself),WIZARD_WEB)  // SPWI215.SPL (Web)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Entangle","LOCALS")
	HaveSpell(CLERIC_ENTANGLE)  // SPPR105.SPL (Entangle)
	NumCreatureGT([EVILCUTOFF],2)
	See(FarthestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),ELEMENTAL)
	!Race(LastSeenBy(Myself),SHADOW)
	!Race(LastSeenBy(Myself),SPECTRE)
	!Race(LastSeenBy(Myself),MIST)
	!Race(LastSeenBy(Myself),WRAITH)
	!Race(LastSeenBy(Myself),SLIME)
	!Race(LastSeenBy(Myself),DRAGON)
	!Class(LastSeenBy(Myself),GIANT)
	!General(LastSeenBy(Myself),PLANT)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,ENTANGLE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(FarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(FarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Entangle","LOCALS",THREE_ROUNDS)
		Spell(FarthestEnemyOf(Myself),CLERIC_ENTANGLE)  // SPPR105.SPL (Entangle)
END

//--------
// DEBUFF
//--------

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Slow","LOCALS")
	HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (Slow)
	NumCreatureGT([EVILCUTOFF],2)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Slow","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_SLOW)  // SPWI312.SPL (Slow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Slow","LOCALS")
	HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (Slow)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Slow","LOCALS",THREE_ROUNDS)
		Spell(SecondNearestEnemyOf(Myself),WIZARD_SLOW)  // SPWI312.SPL (Slow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Slow","LOCALS")
	HaveSpell(WIZARD_SLOW)  // SPWI312.SPL (Slow)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Class(LastSeenBy(Myself),MONK)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_SLOWED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	CheckStatGT(LastSeenBy(Myself),-4,SAVEVSSPELL)
	!CheckStat(LastSeenBy(Myself),8,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Slow","LOCALS",THREE_ROUNDS)
		Spell(ThirdNearestEnemyOf(Myself),WIZARD_SLOW)  // SPWI312.SPL (Slow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_RAY_OF_ENFEEBLEMENT)  // SPWI221.SPL (Ray of Enfeeblement)
	OR(3)
		See([EVILCUTOFF.0.0.PALADIN_ALL])
		See([EVILCUTOFF.0.0.RANGER_ALL])
		See([EVILCUTOFF.0.0.FIGHTER_ALL])
	!Kit(LastSeenBy(Myself),FERALAN)
	!IsWeaponRanged(LastSeenBy(Myself))
	!InParty(LastSeenBy(Myself))
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatGT(LastSeenBy(Myself),5,STR)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),4,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_RAY_OF_ENFEEBLEMENT)  // SPWI221.SPL (Ray of Enfeeblement)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Blind","LOCALS")
	HaveSpell(WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),SLIME)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Blind","LOCALS",THREE_ROUNDS)
		Spell(NearestEnemyOf(Myself),WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Blind","LOCALS")
	HaveSpell(WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),SLIME)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Blind","LOCALS",THREE_ROUNDS)
		Spell(SecondNearestEnemyOf(Myself),WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Blind","LOCALS")
	HaveSpell(WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),SLIME)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatGT(LastSeenBy(Myself),0,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!StateCheck(LastSeenBy(Myself),STATE_BLIND)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),5,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Blind","LOCALS",THREE_ROUNDS)
		Spell(ThirdNearestEnemyOf(Myself),WIZARD_BLINDNESS)  // SPWI106.SPL (Blindness)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_BAura","LOCALS")
	HaveSpell(AURA_OF_DESPAIR)  // SPCL103.SPL (Aura of Despair)
	Range(NearestEnemyOf(Myself),15)
	Range(SecondNearestEnemyOf(Myself),15)
	Range(ThirdNearestEnemyOf(Myself),15)
	NumCreatureGT([EVILCUTOFF],2)
	CheckStatGT([EVILCUTOFF],5,LEVEL)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_BAura","LOCALS",TEN_ROUNDS)
		Spell(Myself,AURA_OF_DESPAIR)  // SPCL103.SPL (Aura of Despair)
END

//------------------
// OFFENSIVE SPELLS
//------------------

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	NumCreatureGT([EVILCUTOFF],2)
	See([EVILCUTOFF.0.TROLL])
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride([EVILCUTOFF.0.TROLL],Range(NearestAllyOf(Myself),15))
	!TriggerOverride([EVILCUTOFF.0.TROLL],Range(NearestEnemyOf(Myself),20))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.0.TROLL],WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(SecondNearest([EVILCUTOFF.0.TROLL]),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(SecondNearest([EVILCUTOFF.0.TROLL]),Range(NearestEnemyOf(Myself),20))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.0.TROLL]),WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(ThirdNearest([EVILCUTOFF.0.TROLL]),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(ThirdNearest([EVILCUTOFF.0.TROLL]),Range(NearestEnemyOf(Myself),20))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF.0.TROLL]),WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
	NumCreatureGT([EVILCUTOFF],2)
	See(FarthestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(FarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(FarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),20))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(FarthestEnemyOf(Myself),WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
	NumCreatureGT([EVILCUTOFF],2)
	See(SecondFarthestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(SecondFarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(SecondFarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),20))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondFarthestEnemyOf(Myself),WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
	NumCreatureGT([EVILCUTOFF],2)
	See(ThirdFarthestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(ThirdFarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(ThirdFarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),20))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdFarthestEnemyOf(Myself),WIZARD_FIREBALL)  // SPWI304.SPL (Fireball)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
	NumCreatureGT([EVILCUTOFF],3)
	See(SecondNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
	NumCreatureGT([EVILCUTOFF],3)
	See(ThirdNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
	NumCreatureGT([EVILCUTOFF],3)
	See(FourthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
	NumCreatureGT([EVILCUTOFF],3)
	See(FifthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
	NumCreatureGT([EVILCUTOFF],3)
	See(SixthNearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_ABI_DALZIMS_HORRID_WILTING)  // SPWI812.SPL (Abi-Dalzim's Horrid Wilting)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_CHAIN_LIGHTNING)  // SPWI615.SPL (Chain Lightning)
	NumCreatureGT([EVILCUTOFF],2)
	See(NearestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),50,RESISTELECTRICITY)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!HasItemEquiped("CLCK24",LastSeenBy(Myself))  // Cloak of Reflection
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	!HasBounceEffects(LastSeenBy(Myself))
	!Range(LastSeenBy(Myself),10)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_CHAIN_LIGHTNING)  // SPWI615.SPL (Chain Lightning)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLY_WORD)  // SPPR710.SPL (Holy Word)
	See(SecondNearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),30)
	OR(3)
		Alignment(LastSeenBy(Myself),CHAOTIC_EVIL)
		Alignment(LastSeenBy(Myself),NEUTRAL_EVIL)
		Alignment(LastSeenBy(Myself),LAWFUL_EVIL)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		MoveToObjectNoInterrupt(LastSeenBy(Myself))
		Spell(Myself,CLERIC_HOLY_WORD)  // SPPR710.SPL (Holy Word)
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	!ModalState(SHAMANDANCE)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_SFire","LOCALS")
	HaveSpell(CLERIC_SPIRIT_FIRE)  // SPPR450.SPL (Spirit Fire)
	See(FarthestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(FarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(FarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_SFire","LOCALS",TWO_ROUNDS)
		Spell(FarthestEnemyOf(Myself),CLERIC_SPIRIT_FIRE)  // SPPR450.SPL (Spirit Fire)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	!ModalState(SHAMANDANCE)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BDU_Writhing","LOCALS")
	HaveSpell(CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
	See(FarthestEnemyOf(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStatLT(LastSeenBy(Myself),50,RESISTCOLD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_IMMOBILE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	TriggerOverride(FarthestEnemyOf(Myself),Range(NearestAllyOf(Myself),15))
	!TriggerOverride(FarthestEnemyOf(Myself),Range(NearestEnemyOf(Myself),22))
	!Range([NEUTRAL],30)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_Writhing","LOCALS",FOUR_ROUNDS)
		Spell(FarthestEnemyOf(Myself),CLERIC_WRITHING_FOG)  // SPPR250.SPL (Writhing Fog)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See([EVILCUTOFF.0.0.MAGE])
	HPGT(LastSeenBy(Myself),50)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSDEATH)
	CheckStatLT(LastSeenBy(Myself),30,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	!HasBounceEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearest([EVILCUTOFF.0.0.MAGE]))
	HPGT(LastSeenBy(Myself),50)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSDEATH)
	CheckStatLT(LastSeenBy(Myself),30,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	!HasBounceEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See([EVILCUTOFF.0.0.MAGE_THIEF])
	HPGT(LastSeenBy(Myself),50)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSDEATH)
	CheckStatLT(LastSeenBy(Myself),30,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	!HasBounceEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearest([EVILCUTOFF.0.0.MAGE_THIEF]))
	HPGT(LastSeenBy(Myself),50)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSDEATH)
	CheckStatLT(LastSeenBy(Myself),30,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	!HasBounceEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See([EVILCUTOFF.0.0.BARD])
	HPGT(LastSeenBy(Myself),50)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSDEATH)
	CheckStatLT(LastSeenBy(Myself),30,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	!HasBounceEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearest([EVILCUTOFF.0.0.BARD]))
	HPGT(LastSeenBy(Myself),50)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSDEATH)
	CheckStatLT(LastSeenBy(Myself),30,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),1,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("RING09",LastSeenBy(Myself))  // Edventar's Gift
	!HasItemEquipedReal("SW2H06",LastSeenBy(Myself))  // Spider's Bane +2
	!HasBounceEffects(LastSeenBy(Myself))
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_BIGBYS_CLENCHED_FIST)  // SPWI818.SPL (Bigby's Clenched Fist)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See([EVILCUTOFF.0.0.MAGE])
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See(SecondNearest([EVILCUTOFF.0.0.MAGE]))
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),7,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See([EVILCUTOFF.0.0.BARD])
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),8,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See(SecondNearest([EVILCUTOFF.0.0.BARD]))
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),8,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See([EVILCUTOFF.0.0.THIEF])
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),8,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See(SecondNearest([EVILCUTOFF.0.0.THIEF]))
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),8,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See([EVILCUTOFF.0.0.MAGE_THIEF])
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),8,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
	See(SecondNearest([EVILCUTOFF.0.0.MAGE_THIEF]))
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatGT(LastSeenBy(Myself),8,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),WIZARD_FINGER_OF_DEATH)  // SPWI713.SPL (Finger of Death)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	!GlobalTimerNotExpired("BD_Wand","LOCALS")
	HasItem("WAND11",Myself)  // Wand of the Heavens
	NumCreatureGT([EVILCUTOFF],1)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BD_Wand","LOCALS",THREE_ROUNDS)
		DisplayStringHead(Myself,31971)  // *uses a wand*
		UseItem("WAND11",LastSeenBy(Myself))  // Wand of the Heavens
		SetSequence(SEQ_CAST)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
	See([EVILCUTOFF])
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
	See(SecondNearest([EVILCUTOFF]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
	See(ThirdNearest([EVILCUTOFF]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
	See(FourthNearest([EVILCUTOFF]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
	See(FifthNearest([EVILCUTOFF]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
	See(SixthNearest([EVILCUTOFF]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),75,RESISTFIRE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_FLAME_STRIKE)  // SPPR503.SPL (Flame Strike)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CAUSE_CRITICAL_WOUNDS)  // SPPR510.SPL (Cause Critical Wounds)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),4)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),SLIME)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),MEPHIT)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CAUSE_CRITICAL_WOUNDS)  // SPPR510.SPL (Cause Critical Wounds)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_CAUSE_SERIOUS_WOUNDS)  // SPPR414.SPL (Cause Serious Wounds)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),4)
	!General(LastSeenBy(Myself),UNDEAD)
	!Race(LastSeenBy(Myself),SLIME)
	!Race(LastSeenBy(Myself),DEMONIC)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),MEPHIT)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_CAUSE_SERIOUS_WOUNDS)  // SPPR414.SPL (Cause Serious Wounds)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HARM)  // SPPR608.SPL (Harm)
	OR(3)
		Class(Myself,FIGHTER_ALL)
		Class(Myself,RANGER_ALL)
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	Range([EVILCUTOFF],8)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #10
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,CLERIC_HARM)  // SPPR608.SPL (Harm)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	Range([EVILCUTOFF.0.TROLL],30)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	!Range([EVILCUTOFF],8)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	Range(SecondNearest([EVILCUTOFF.0.TROLL]),30)
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	!Range([EVILCUTOFF],8)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	Range(ThirdNearest([EVILCUTOFF.0.TROLL]),30)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	!Range([EVILCUTOFF],8)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	Range(FourthNearest([EVILCUTOFF.0.TROLL]),30)
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	!Range([EVILCUTOFF],8)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	Range(FifthNearest([EVILCUTOFF.0.TROLL]),30)
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	!Range([EVILCUTOFF],8)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	Range(SixthNearest([EVILCUTOFF.0.TROLL]),30)
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	!Range([EVILCUTOFF],8)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!HasItem("HARM",Myself)  // Harm
	!HasItem("SLAYLIVE",Myself)  // Slay Living
	NumCreatureGT([EVILCUTOFF],3)
	!Range([EVILCUTOFF],8)
	CheckStatLT([EVILCUTOFF],76,RESISTFIRE)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See([EVILCUTOFF.0.0.0.0.0.MASK_EVIL])
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!Range([GOODCUTOFF.0.0.0.0.0.MASK_EVIL],30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearest([EVILCUTOFF.0.0.0.0.0.MASK_EVIL]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!Range([GOODCUTOFF.0.0.0.0.0.MASK_EVIL],30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(ThirdNearest([EVILCUTOFF.0.0.0.0.0.MASK_EVIL]))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!Range([GOODCUTOFF.0.0.0.0.0.MASK_EVIL],30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_HOLY_SMITE)  // SPPR313.SPL (Holy Smite)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_UNHOLY_BLIGHT)  // SPPR314.SPL (Unholy Blight)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See([EVILCUTOFF.0.0.0.0.0.MASK_EVIL])
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!Range([GOODCUTOFF.0.0.0.0.0.MASK_EVIL],30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_UNHOLY_BLIGHT)  // SPPR314.SPL (Unholy Blight)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_UNHOLY_BLIGHT)  // SPPR314.SPL (Unholy Blight)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearest([EVILCUTOFF.0.0.0.0.0.MASK_EVIL]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!Range([GOODCUTOFF.0.0.0.0.0.MASK_EVIL],30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_UNHOLY_BLIGHT)  // SPPR314.SPL (Unholy Blight)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(CLERIC_UNHOLY_BLIGHT)  // SPPR314.SPL (Unholy Blight)
	CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(ThirdNearest([EVILCUTOFF.0.0.0.0.0.MASK_EVIL]))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!Race(LastSeenBy(Myself),GOLEM)
	!Range([GOODCUTOFF.0.0.0.0.0.MASK_EVIL],30)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
	!HasItemEquiped("CLCK26",LastSeenBy(Myself))  // Cloak of Mirroring
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(LastSeenBy(Myself),CLERIC_UNHOLY_BLIGHT)  // SPPR314.SPL (Unholy Blight)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	See([EVILCUTOFF.0.TROLL])
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.0.TROLL],WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SecondNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.0.TROLL]),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF.0.TROLL]),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FourthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(FourthNearest([EVILCUTOFF.0.TROLL]),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FifthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(FifthNearest([EVILCUTOFF.0.TROLL]),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SixthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SixthNearest([EVILCUTOFF.0.TROLL]),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(NearestEnemyOf(Myself),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearestEnemyOf(Myself),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
	See(ThirdNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearestEnemyOf(Myself),WIZARD_FLAME_ARROW)  // SPWI303.SPL (Flame Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	See([EVILCUTOFF.0.TROLL])
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.0.TROLL],WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SecondNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.0.TROLL]),WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF.0.TROLL]),WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FourthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(FourthNearest([EVILCUTOFF.0.TROLL]),WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FifthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(FifthNearest([EVILCUTOFF.0.TROLL]),WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SixthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTACID)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SixthNearest([EVILCUTOFF.0.TROLL]),WIZARD_MELF_ACID_ARROW)  // SPWI211.SPL (Melf's Acid Arrow)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(LastSeenBy(Myself),31,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),31,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),2,DEFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(NearestEnemyOf(Myself),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(LastSeenBy(Myself),31,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),31,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),2,DEFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearestEnemyOf(Myself),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
	See(ThirdNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	!Race(LastSeenBy(Myself),GOLEM)
	!Race(LastSeenBy(Myself),LICH)
	!Race(LastSeenBy(Myself),DEMILICH)
	!Race(LastSeenBy(Myself),RAKSHASA)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatLT(LastSeenBy(Myself),31,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),31,MAGICDAMAGERESISTANCE)
	!CheckStat(LastSeenBy(Myself),2,DEFENSIVE_MODIFIER)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearestEnemyOf(Myself),WIZARD_MAGIC_MISSILE)  // SPWI112.SPL (Magic Missile)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	RandomNum(8,1)
	HaveSpell(WIZARD_CHROMATIC_ORB)  // SPWI118.SPL (Chromatic Orb)
	See([EVILCUTOFF.HUMANOID])
	!InParty(LastSeenBy(Myself))
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	!StateCheck(LastSeenBy(Myself),STATE_DISABLED)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	CheckStatGT(LastSeenBy(Myself),6,SAVEVSSPELL)
	CheckStatLT(LastSeenBy(Myself),31,RESISTMAGIC)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),6,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.HUMANOID],WIZARD_CHROMATIC_ORB)  // SPWI118.SPL (Chromatic Orb)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	See([EVILCUTOFF.0.TROLL])
	!InParty(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),8)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell([EVILCUTOFF.0.TROLL],WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SecondNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),8)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SecondNearest([EVILCUTOFF.0.TROLL]),WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),8)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(ThirdNearest([EVILCUTOFF.0.TROLL]),WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FourthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),8)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(FourthNearest([EVILCUTOFF.0.TROLL]),WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FifthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),8)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(FifthNearest([EVILCUTOFF.0.TROLL]),WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SixthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	Range(LastSeenBy(Myself),8)
	!StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	CheckStatLT(LastSeenBy(Myself),55,RESISTFIRE)
	CheckStat(LastSeenBy(Myself),0,MINORGLOBE)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TURNING)
	!CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_TRAP)
	!CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
	!CheckStat(LastSeenBy(Myself),2,WIZARD_SPELL_IMMUNITY)
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(SixthNearest([EVILCUTOFF.0.TROLL]),WIZARD_BURNING_HANDS)  // SPWI103.SPL (Burning Hands)
END

//-------------
// COMBAT BUFF
//-------------

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_BLACK_BLADE_OF_DISASTER)  // SPWI915.SPL (Black Blade of Disaster)
	CheckStatGT(Myself,0,PROFICIENCYLONGSWORD)
	See([EVILCUTOFF])
	CheckStatGT([EVILCUTOFF],9,LEVEL)
	Range(LastSeenBy(Myself),10)
	!HasItem("BLAKBLAD",Myself)  // Black Blade of Disaster
	!HasItem("PHANBLAD",Myself)  // Phantom Blade
	!HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	CheckStatLT(Myself,50,SPELLFAILUREMAGE)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_BLACK_BLADE_OF_DISASTER)  // SPWI915.SPL (Black Blade of Disaster)
END

IF
	Global("BDAI_DISABLE_OFFENSIVE","LOCALS",0)
	Global("BDAI_NO_ARCANE","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(WIZARD_TENSERS_TRANSFORMATION)  // SPWI603.SPL (Tenser's Transformation)
	Global("BDAI_ATTACK_MODE","LOCALS",1)
	OR(2)
		NumCreatureGT([EVILCUTOFF],4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,WIZARD_TENSERS_TRANSFORMATION)  // SPWI603.SPL (Tenser's Transformation)
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN11",Myself)  // Potion of Invulnerability
	HPPercentLT(Myself,71)
	CheckStatGT(Myself,0,SAVEVSSPELL)
	NumCreatureGT([EVILCUTOFF],3)
	Global("BDU_InCombat","GLOBAL",1)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN11",Myself)  // Potion of Invulnerability
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN12",Myself)  // Potion of Stone Giant Strength
	CheckStatLT(Myself,20,STR)
	NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN12",Myself)  // Potion of Stone Giant Strength
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN03",Myself)  // Potion of Hill Giant Strength
	CheckStatLT(Myself,19,STR)
	NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN03",Myself)  // Potion of Hill Giant Strength
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPIN826")  // Strength
	NumCreatureGT([EVILCUTOFF],3)
	CheckStatLT(Myself,18,STR)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPIN826",Myself)  // Strength
END

IF
	Global("BDAI_DISABLE_ITEMS","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HasItem("POTN37",Myself)  // Potion of Mind Focusing
	CheckStatLT(Myself,19,DEX)
	NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		UseItem("POTN37",Myself)  // Potion of Mind Focusing
		DisplayStringHead(Myself,46150)  // *quaffs a potion*
END

//------------------
// INNATE OFFENSIVE
//------------------

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(KENSAI_KIA)  // SPCL144.SPL (Kai)
	!CheckSpellState(Myself,KENSAI_KIA)
	Range(NearestEnemyOf(Myself),6)
	See([EVILCUTOFF])
	OR(2)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,KENSAI_KIA)  // SPCL144.SPL (Kai)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(BLADE_OFFENSIVE_SPIN)  // SPCL521.SPL (Offensive Spin)
	!CheckSpellState(Myself,OFFENSIVE_SPIN)
	!CheckSpellState(Myself,DEFENSIVE_SPIN)
	Range(NearestEnemyOf(Myself),6)
	See([EVILCUTOFF])
	OR(2)
		CheckStatGT(LastSeenBy(Myself),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],3)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,BLADE_OFFENSIVE_SPIN)  // SPCL521.SPL (Offensive Spin)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(ARCHER_CALL_SHOT)  // SPCL121.SPL (Called Shot)
	!CheckSpellState(Myself,ARCHER_CALL_SHOT)
	IsWeaponRanged(Myself)
	!Range([EVILCUTOFF],5)
	OR(4)
		CheckStatGT([EVILCUTOFF],9,LEVEL)
		CheckStatGT(SecondNearest([EVILCUTOFF]),9,LEVEL)
		CheckStatGT(ThirdNearest([EVILCUTOFF]),9,LEVEL)
		NumCreatureGT([EVILCUTOFF],4)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,ARCHER_CALL_SHOT)  // SPCL121.SPL (Called Shot)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(ASSASSIN_POISON)  // SPCL423.SPL (Poison Weapon)
	!CheckSpellState(Myself,POISON_WEAPON)
	CheckStatGT(NearestEnemyOf(Myself),4,LEVEL)
	!General(NearestEnemyOf(Myself),UNDEAD)
	!Race(NearestEnemyOf(Myself),GOLEM)
	!Race(NearestEnemyOf(Myself),SWORD)
	CheckStatLT(NearestEnemyOf(Myself),100,RESISTPOISON)
	Range(NearestEnemyOf(Myself),6)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,ASSASSIN_POISON)  // SPCL423.SPL (Poison Weapon)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(MONK_QUIVERING_PALM)  // SPCL820.SPL (Quivering Palm)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),7)
	!StateCheck(LastSeenBy(Myself),STATE_HELPLESS)
	!StateCheck(LastSeenBy(Myself),STATE_PANIC)
	!StateCheck(LastSeenBy(Myself),STATE_CHARMED)
	!General(LastSeenBy(Myself),UNDEAD)
	!CheckStatGT(LastSeenBy(Myself),0,DEATH_WARD)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,MONK_QUIVERING_PALM)  // SPCL820.SPL (Quivering Palm)
		AttackReevaluate(NearestEnemyOf(Myself),45)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpell(MONK_STUNNING_BLOW)  // SPCL811.SPL (Stunning Blow)
	See(NearestEnemyOf(Myself))
	Range(LastSeenBy(Myself),7)
	!General(LastSeenBy(Myself),UNDEAD)
	!StateCheck(LastSeenBy(Myself),STATE_HARMLESS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_CHAOTIC_COMMANDS)
	!CheckStatGT(LastSeenBy(Myself),0,CLERIC_FREE_ACTION)
	!CheckStat(LastSeenBy(Myself),1,OFFENSIVE_MODIFIER)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		Spell(Myself,MONK_STUNNING_BLOW)  // SPCL811.SPL (Stunning Blow)
		AttackReevaluate(LastSeenBy(Myself),45)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL237")  // Greater Sun
	Range(NearestEnemyOf(Myself),30)
	CheckStatLT(Myself,50,RESISTFIRE)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
	OR(4)
		HitBy([ANYONE],CRUSHING)
		HitBy([ANYONE],SLASHING)
		HitBy([ANYONE],PIERCING)
		HitBy([ANYONE],FIRE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL237",Myself)  // Greater Sun
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL238")  // Flaming Fists
	!GlobalTimerNotExpired("BDU_FFists","LOCALS")
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	Range([EVILCUTOFF.0.TROLL],30)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_FFists","LOCALS",FIVE_ROUNDS)
		SpellRES("SPCL238",Myself)  // Flaming Fists
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL238")  // Flaming Fists
	!GlobalTimerNotExpired("BDU_FFists","LOCALS")
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	Range(SecondNearest([EVILCUTOFF.0.TROLL]),30)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_FFists","LOCALS",FIVE_ROUNDS)
		SpellRES("SPCL238",Myself)  // Flaming Fists
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL238")  // Flaming Fists
	!GlobalTimerNotExpired("BDU_FFists","LOCALS")
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	Range(ThirdNearest([EVILCUTOFF.0.TROLL]),30)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_FFists","LOCALS",FIVE_ROUNDS)
		SpellRES("SPCL238",Myself)  // Flaming Fists
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL238")  // Flaming Fists
	!GlobalTimerNotExpired("BDU_FFists","LOCALS")
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	Range(FourthNearest([EVILCUTOFF.0.TROLL]),30)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_FFists","LOCALS",FIVE_ROUNDS)
		SpellRES("SPCL238",Myself)  // Flaming Fists
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL238")  // Flaming Fists
	!GlobalTimerNotExpired("BDU_FFists","LOCALS")
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	Range(FifthNearest([EVILCUTOFF.0.TROLL]),30)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_FFists","LOCALS",FIVE_ROUNDS)
		SpellRES("SPCL238",Myself)  // Flaming Fists
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL238")  // Flaming Fists
	!GlobalTimerNotExpired("BDU_FFists","LOCALS")
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	Range(SixthNearest([EVILCUTOFF.0.TROLL]),30)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_FFists","LOCALS",FIVE_ROUNDS)
		SpellRES("SPCL238",Myself)  // Flaming Fists
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL238")  // Flaming Fists
	!GlobalTimerNotExpired("BDU_FFists","LOCALS")
	CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
	CheckStatLT(NearestEnemyOf(Myself),100,RESISTFIRE)
	Range(NearestEnemyOf(Myself),6)
	!StateCheck(Myself,STATE_SILENCED)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_FFists","LOCALS",FIVE_ROUNDS)
		SpellRES("SPCL238",Myself)  // Flaming Fists
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	See([EVILCUTOFF.0.TROLL])
	!InParty(LastSeenBy(Myself))
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",[EVILCUTOFF.0.TROLL])  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SecondNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",SecondNearest([EVILCUTOFF.0.TROLL]))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",ThirdNearest([EVILCUTOFF.0.TROLL]))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FourthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",FourthNearest([EVILCUTOFF.0.TROLL]))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FifthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",FifthNearest([EVILCUTOFF.0.TROLL]))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SixthNearest([EVILCUTOFF.0.TROLL]))
	!InParty(LastSeenBy(Myself))
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",SixthNearest([EVILCUTOFF.0.TROLL]))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	See(NearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	OR(2)
		CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
		General(NearestEnemyOf(Myself),UNDEAD)
	Range(LastSeenBy(Myself),10)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",NearestEnemyOf(Myself))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	See(SecondNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	OR(2)
		CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
		General(NearestEnemyOf(Myself),UNDEAD)
	Range(LastSeenBy(Myself),10)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",SecondNearestEnemyOf(Myself))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	See(ThirdNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	OR(2)
		CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
		General(NearestEnemyOf(Myself),UNDEAD)
	Range(LastSeenBy(Myself),10)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",ThirdNearestEnemyOf(Myself))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	See(FourthNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	OR(2)
		CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
		General(NearestEnemyOf(Myself),UNDEAD)
	Range(LastSeenBy(Myself),10)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",FourthNearestEnemyOf(Myself))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	See(FifthNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	OR(2)
		CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
		General(NearestEnemyOf(Myself),UNDEAD)
	Range(LastSeenBy(Myself),10)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",FifthNearestEnemyOf(Myself))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		!GlobalTimerNotExpired("BD_Cast","LOCALS")
		CheckStatGT(Myself,0,AURACLEANSING)
	HaveSpellRES("SPCL236")  // Sun Soulray
	See(SixthNearestEnemyOf(Myself))
	!InParty(LastSeenBy(Myself))
	OR(2)
		CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
		General(NearestEnemyOf(Myself),UNDEAD)
	Range(LastSeenBy(Myself),10)
	!StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
	CheckStatLT(LastSeenBy(Myself),50,RESISTFIRE)
	CheckStatLT(LastSeenBy(Myself),50,RESISTMAGIC)
	!StateCheck(Myself,STATE_SILENCED)
	!CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
THEN
	RESPONSE #100
		SetInterrupt(FALSE)
		SetGlobalTimer("BD_Cast","LOCALS",ONE_ROUND)
		SpellRES("SPCL236",SixthNearestEnemyOf(Myself))  // Sun Soulray
		SetInterrupt(TRUE)
END

IF
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	InParty(Myself)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	HasItem("AROW08",Myself)  // Arrow of Fire +2
	!CurrentAmmo("AROW08",Myself)  // Arrow of Fire +2
	!CurrentAmmo("AROW04",Myself)  // Acid Arrow +1
THEN
	RESPONSE #100
		XEquipItem("AROW08",Myself,SLOT_AMMO0,EQUIP)  // Arrow of Fire +2
		Continue()
END

IF
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	InParty(Myself)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	HasItem("AROW04",Myself)  // Acid Arrow +1
	!CurrentAmmo("AROW08",Myself)  // Arrow of Fire +2
	!CurrentAmmo("AROW04",Myself)  // Acid Arrow +1
THEN
	RESPONSE #100
		XEquipItem("AROW04",Myself,SLOT_AMMO0,EQUIP)  // Acid Arrow +1
		Continue()
END

// Stop song if out of combat
IF
	ActionListEmpty()
	InParty(Myself)
	ModalState(BATTLESONG)
	!Global("BDU_InCombat","GLOBAL",1)
	Global("BDU_BrdS","LOCALS",1)
THEN
	RESPONSE #100
		SetGlobal("BDU_BrdS","LOCALS",0)
		SetGlobal("BDU_SongTimer","LOCALS",0)
		SetGlobal("BDU_SongRepeatTimer","LOCALS",0)
		ClearActions(Myself)
END

// Initiate song
IF
	ActionListEmpty()
	InParty(Myself)
	!ModalState(BATTLESONG)
	!CheckSpellState(Myself,SKALD_SONG)
	OR(2)
		Class(Myself,BARD_ALL)
		Class(Myself,SHAMAN)
	Global("BDU_InCombat","GLOBAL",1)
	!GlobalTimerNotExpired("BDU_SongRepeatTimer","LOCALS")
THEN
	RESPONSE #100
		SetGlobal("BDU_BrdS","LOCALS",1)
		SetGlobalTimer("BDU_SongTimer","LOCALS",ONE_ROUND)
		SetGlobalTimer("BDU_SongRepeatTimer","LOCALS",TWO_ROUNDS)
		BattleSong()
END

// Make sure song continues one round before fighting
IF
	ActionListEmpty()
	InParty(Myself)
	OR(2)
		Class(Myself,BARD_ALL)
		Class(Myself,SHAMAN)
	Global("BDU_InCombat","GLOBAL",1)
	GlobalTimerNotExpired("BDU_SongTimer","LOCALS")
	GlobalTimerNotExpired("BDU_SongRepeatTimer","LOCALS")
THEN
	RESPONSE #100
		BattleSong()
END

//-----------
// TARGETING
//-----------

// Target nearest enemy (default)
IF
	OR(2)
		See([EVILCUTOFF])
		See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOf(Myself))
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target nearest enemies you can damage
IF
	!InParty(SixthNearestEnemyOf(Myself))
	!Allegiance(SixthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CHARMED)
	WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	See(SixthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(FifthNearestEnemyOf(Myself))
	!Allegiance(FifthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CHARMED)
	WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
	See(FifthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(FourthNearestEnemyOf(Myself))
	!Allegiance(FourthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CHARMED)
	WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
	See(FourthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(ThirdNearestEnemyOf(Myself))
	!Allegiance(ThirdNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
	See(ThirdNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(SecondNearestEnemyOf(Myself))
	!Allegiance(SecondNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
	See(SecondNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOf(Myself))
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target capable enemies that you can damage
IF
	!InParty(SixthNearestEnemyOf(Myself))
	!Allegiance(SixthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	See(SixthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(FifthNearestEnemyOf(Myself))
	!Allegiance(FifthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
	See(FifthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(FourthNearestEnemyOf(Myself))
	!Allegiance(FourthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
	See(FourthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(ThirdNearestEnemyOf(Myself))
	!Allegiance(ThirdNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
	See(ThirdNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(SecondNearestEnemyOf(Myself))
	!Allegiance(SecondNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
	See(SecondNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOf(Myself))
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(NearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target attacker of most hurt party member
IF
	HPPercentLT(MostDamagedOf([PC]),100)
	!InParty(LastAttackerOf(MostDamagedOf([PC])))
	!Allegiance(LastAttackerOf(MostDamagedOf([PC])),GOODCUTOFF)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_REALLY_DEAD)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_SLEEPING)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_PANIC)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_STUNNED)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_CHARMED)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_CONFUSED)
	WeaponEffectiveVs(LastAttackerOf(MostDamagedOf([PC])),MAINHAND)
	WeaponCanDamage(LastAttackerOf(MostDamagedOf([PC])),MAINHAND)
	See(LastAttackerOf(MostDamagedOf([PC])))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target boss if protector
IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(SixthNearestEnemyOf(Myself))
	!Allegiance(SixthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(SixthNearestEnemyOf(Myself),5,LEVEL)
	See(SixthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(FifthNearestEnemyOf(Myself))
	!Allegiance(FifthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(FifthNearestEnemyOf(Myself),5,LEVEL)
	See(FifthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(FourthNearestEnemyOf(Myself))
	!Allegiance(FourthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(FourthNearestEnemyOf(Myself),5,LEVEL)
	See(FourthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(ThirdNearestEnemyOf(Myself))
	!Allegiance(ThirdNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(ThirdNearestEnemyOf(Myself),5,LEVEL)
	See(ThirdNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(SecondNearestEnemyOf(Myself))
	!Allegiance(SecondNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(SecondNearestEnemyOf(Myself),5,LEVEL)
	See(SecondNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(NearestEnemyOf(Myself))
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(NearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(NearestEnemyOf(Myself),5,LEVEL)
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target high level boss if protector (BG1/TotSC)
IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(SixthNearestEnemyOf(Myself))
	!Allegiance(SixthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(SixthNearestEnemyOf(Myself),9,LEVEL)
	See(SixthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(FifthNearestEnemyOf(Myself))
	!Allegiance(FifthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(FifthNearestEnemyOf(Myself),9,LEVEL)
	See(FifthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(FourthNearestEnemyOf(Myself))
	!Allegiance(FourthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(FourthNearestEnemyOf(Myself),9,LEVEL)
	See(FourthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(ThirdNearestEnemyOf(Myself))
	!Allegiance(ThirdNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(ThirdNearestEnemyOf(Myself),9,LEVEL)
	See(ThirdNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(SecondNearestEnemyOf(Myself))
	!Allegiance(SecondNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(SecondNearestEnemyOf(Myself),9,LEVEL)
	See(SecondNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(NearestEnemyOf(Myself))
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(NearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(NearestEnemyOf(Myself),9,LEVEL)
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target high level boss if protector (SoD/BP)
IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(SixthNearestEnemyOf(Myself))
	!Allegiance(SixthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SixthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SixthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SixthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(SixthNearestEnemyOf(Myself),12,LEVEL)
	See(SixthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(FifthNearestEnemyOf(Myself))
	!Allegiance(FifthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FifthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FifthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FifthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(FifthNearestEnemyOf(Myself),12,LEVEL)
	See(FifthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(FourthNearestEnemyOf(Myself))
	!Allegiance(FourthNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(FourthNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(FourthNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(FourthNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(FourthNearestEnemyOf(Myself),12,LEVEL)
	See(FourthNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(ThirdNearestEnemyOf(Myself))
	!Allegiance(ThirdNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(ThirdNearestEnemyOf(Myself),12,LEVEL)
	See(ThirdNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(SecondNearestEnemyOf(Myself))
	!Allegiance(SecondNearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(SecondNearestEnemyOf(Myself),12,LEVEL)
	See(SecondNearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	Global("BDU_Protector","LOCALS",1)
	!InParty(NearestEnemyOf(Myself))
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOf(Myself),STATE_SLEEPING)
	!StateCheck(NearestEnemyOf(Myself),STATE_PANIC)
	!StateCheck(NearestEnemyOf(Myself),STATE_STUNNED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CHARMED)
	!StateCheck(NearestEnemyOf(Myself),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
	CheckStatGT(NearestEnemyOf(Myself),12,LEVEL)
	See(NearestEnemyOf(Myself))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target attacker of most hurt party member
IF
	HPPercentLT(MostDamagedOf([PC]),61)
	!InParty(LastAttackerOf(MostDamagedOf([PC])))
	!Allegiance(LastAttackerOf(MostDamagedOf([PC])),GOODCUTOFF)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_REALLY_DEAD)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_SLEEPING)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_PANIC)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_STUNNED)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_CHARMED)
	!StateCheck(LastAttackerOf(MostDamagedOf([PC])),STATE_CONFUSED)
	WeaponEffectiveVs(LastAttackerOf(MostDamagedOf([PC])),MAINHAND)
	WeaponCanDamage(LastAttackerOf(MostDamagedOf([PC])),MAINHAND)
	See(LastAttackerOf(MostDamagedOf([PC])))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target vampires
IF
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),MAINHAND)
	Range(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),10)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),MAINHAND)
	WeaponCanDamage(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),MAINHAND)
	Range(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]),10)
	See(NearestEnemyOfType([EVILCUTOFF.0.VAMPIRE]))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target clerics / druids
IF
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),MAINHAND)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),MAINHAND)
	WeaponCanDamage(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]),MAINHAND)
	See(NearestEnemyOfType([EVILCUTOFF.0.0.DRUID_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),MAINHAND)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),MAINHAND)
	WeaponCanDamage(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]),MAINHAND)
	See(NearestEnemyOfType([EVILCUTOFF.0.0.CLERIC_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target beholders
IF
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),MAINHAND)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),MAINHAND)
	WeaponCanDamage(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]),MAINHAND)
	See(NearestEnemyOfType([EVILCUTOFF.0.BEHOLDER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target mages
IF
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),MAINHAND)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),MAINHAND)
	WeaponCanDamage(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]),MAINHAND)
	See(NearestEnemyOfType([EVILCUTOFF.0.0.MAGE_ALL]))
	False()
THEN
	RESPONSE #100
		Continue()
END

// Target mind flayers if close
IF
	!InParty(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]))
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_REALLY_DEAD)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_SLEEPING)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_PANIC)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_STUNNED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CHARMED)
	!StateCheck(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CONFUSED)
	WeaponEffectiveVs(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),MAINHAND)
	Range(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),10)
	See(SecondNearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

IF
	!InParty(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]))
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_REALLY_DEAD)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_SLEEPING)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_PANIC)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_STUNNED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CHARMED)
	!StateCheck(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),STATE_CONFUSED)
	WeaponEffectiveVs(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),MAINHAND)
	WeaponCanDamage(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),MAINHAND)
	Range(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]),10)
	See(NearestEnemyOfType([EVILCUTOFF.0.MIND_FLAYER]))
	False()
THEN
	RESPONSE #100
		Continue()
END

//----------------------------
// NEW ATTACK WITH TARGETTING
//----------------------------

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat(Myself,0,SANCTUARY)
	!InParty(LastSeenBy(Myself))
	!Allegiance(LastSeenBy(Myself),NEUTRAL)
	!StateCheck(LastSeenBy(Myself),STATE_REALLY_DEAD)
	See(LastSeenBy(Myself))
THEN
	RESPONSE #100
		AttackOneRound(LastSeenBy(Myself))
END

//---------------------
// OLD ATTACK FALLBACK
//---------------------

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	See([EVILCUTOFF.0.TROLL])
	HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!StateCheck([EVILCUTOFF.0.TROLL],STATE_REALLY_DEAD)
	!Allegiance([EVILCUTOFF.0.TROLL],GOODCUTOFF)
	!InParty([EVILCUTOFF.0.TROLL])
THEN
	RESPONSE #100
		AttackOneRound([EVILCUTOFF.0.TROLL])
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(ThirdNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(ThirdNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(ThirdNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(SecondNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(ThirdNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(ThirdNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(ThirdNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(ThirdNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FourthNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(FourthNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(FourthNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(FourthNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(FourthNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FifthNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(FifthNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(FifthNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(FifthNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(FifthNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	HasItem("MELFMET",Myself)  // Melf's Minute Meteor
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SixthNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(SixthNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(SixthNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(SixthNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(SixthNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	See([EVILCUTOFF.0.TROLL])
	GlobalTimerNotExpired("BDU_FFists","LOCALS")
	!StateCheck([EVILCUTOFF.0.TROLL],STATE_REALLY_DEAD)
	!Allegiance([EVILCUTOFF.0.TROLL],GOODCUTOFF)
	!InParty([EVILCUTOFF.0.TROLL])
THEN
	RESPONSE #100
		AttackOneRound([EVILCUTOFF.0.TROLL])
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	GlobalTimerNotExpired("BDU_FFists","LOCALS")
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(ThirdNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(ThirdNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(ThirdNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(SecondNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	GlobalTimerNotExpired("BDU_FFists","LOCALS")
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(ThirdNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(ThirdNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(ThirdNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(ThirdNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	GlobalTimerNotExpired("BDU_FFists","LOCALS")
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(FourthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FourthNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(FourthNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(FourthNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(FourthNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(FourthNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	GlobalTimerNotExpired("BDU_FFists","LOCALS")
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(FifthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(FifthNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(FifthNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(FifthNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(FifthNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(FifthNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	GlobalTimerNotExpired("BDU_FFists","LOCALS")
	!StateCheck(Myself,STATE_INVISIBLE)
	CheckStat(SixthNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	See(SixthNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(SixthNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(SixthNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(SixthNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(SixthNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat([EVILCUTOFF.0.TROLL],100,RESISTSLASHING)
	OR(2)
		CurrentAmmo("AROW08",Myself)  // Arrow of Fire +2
		CurrentAmmo("AROW04",Myself)  // Acid Arrow +1
	See([EVILCUTOFF.0.TROLL])
	!StateCheck([EVILCUTOFF.0.TROLL],STATE_REALLY_DEAD)
	!Allegiance([EVILCUTOFF.0.TROLL],GOODCUTOFF)
	!InParty([EVILCUTOFF.0.TROLL])
THEN
	RESPONSE #100
		AttackOneRound([EVILCUTOFF.0.TROLL])
END

IF
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat(SecondNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	OR(2)
		CurrentAmmo("AROW08",Myself)  // Arrow of Fire +2
		CurrentAmmo("AROW04",Myself)  // Acid Arrow +1
	See(SecondNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(SecondNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(SecondNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(SecondNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(SecondNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_ATTACK_MODE","LOCALS",2)
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat(ThirdNearest([EVILCUTOFF.0.TROLL]),100,RESISTSLASHING)
	OR(2)
		CurrentAmmo("AROW08",Myself)  // Arrow of Fire +2
		CurrentAmmo("AROW04",Myself)  // Acid Arrow +1
	See(ThirdNearest([EVILCUTOFF.0.TROLL]))
	!StateCheck(ThirdNearest([EVILCUTOFF.0.TROLL]),STATE_REALLY_DEAD)
	!Allegiance(ThirdNearest([EVILCUTOFF.0.TROLL]),GOODCUTOFF)
	!InParty(ThirdNearest([EVILCUTOFF.0.TROLL]))
THEN
	RESPONSE #100
		AttackOneRound(ThirdNearest([EVILCUTOFF.0.TROLL]))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat(Myself,0,SANCTUARY)
	WeaponEffectiveVs(NearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(NearestEnemyOf(Myself),MAINHAND)
	See(NearestEnemyOf(Myself))
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!InParty(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		AttackOneRound(NearestEnemyOf(Myself))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat(Myself,0,SANCTUARY)
	WeaponEffectiveVs(SecondNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(SecondNearestEnemyOf(Myself),MAINHAND)
	See(SecondNearestEnemyOf(Myself))
	!StateCheck(SecondNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!Allegiance(SecondNearestEnemyOf(Myself),GOODCUTOFF)
	!InParty(SecondNearestEnemyOf(Myself))
THEN
	RESPONSE #100
		AttackOneRound(SecondNearestEnemyOf(Myself))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat(Myself,0,SANCTUARY)
	WeaponEffectiveVs(ThirdNearestEnemyOf(Myself),MAINHAND)
	WeaponCanDamage(ThirdNearestEnemyOf(Myself),MAINHAND)
	See(ThirdNearestEnemyOf(Myself))
	!StateCheck(ThirdNearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!Allegiance(ThirdNearestEnemyOf(Myself),GOODCUTOFF)
	!InParty(ThirdNearestEnemyOf(Myself))
THEN
	RESPONSE #100
		AttackOneRound(ThirdNearestEnemyOf(Myself))
END

IF
	Global("BDAI_DISABLE_ATTACK","LOCALS",0)
	ActionListEmpty()
	InParty(Myself)
	CheckStat(Myself,0,SANCTUARY)
	See(NearestEnemyOf(Myself))
	!StateCheck(NearestEnemyOf(Myself),STATE_REALLY_DEAD)
	!Allegiance(NearestEnemyOf(Myself),GOODCUTOFF)
	!InParty(NearestEnemyOf(Myself))
THEN
	RESPONSE #100
		AttackOneRound(NearestEnemyOf(Myself))
END
